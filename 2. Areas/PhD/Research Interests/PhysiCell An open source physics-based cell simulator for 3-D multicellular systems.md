Open Access

Peer-reviewed

Research Article

-   Ahmadreza Ghaffarizadeh, 
-   Randy Heiland, 
-   Samuel H. Friedman, 
-   Shannon M. Mumenthaler, 
-   Paul Macklin

![PLOS](https://journals.plos.org/ploscompbiol/resource/img/logo-plos.png)

x

-   Published: February 23, 2018
-   [https://doi.org/10.1371/journal.pcbi.1005991](https://doi.org/10.1371/journal.pcbi.1005991)
-   [See the preprint](https://doi.org/10.1101/088773)

## Abstract

Many multicellular systems problems can only be understood by studying how cells move, grow, divide, interact, and die. Tissue-scale dynamics emerge from systems of many interacting cells as they respond to and influence their microenvironment. The ideal “virtual laboratory” for such multicellular systems simulates both the biochemical microenvironment (the “stage”) and many mechanically and biochemically interacting cells (the “players” upon the stage). PhysiCell—physics-based multicellular simulator—is an open source agent-based simulator that provides both the stage and the players for studying many interacting cells in dynamic tissue microenvironments. It builds upon a multi-substrate biotransport solver to link cell phenotype to multiple diffusing substrates and signaling factors. It includes biologically-driven sub-models for cell cycling, apoptosis, necrosis, solid and fluid volume changes, mechanics, and motility “out of the box.” The C++ code has minimal dependencies, making it simple to maintain and deploy across platforms. PhysiCell has been parallelized with OpenMP, and its performance scales linearly with the number of cells. Simulations up to 105\-106 cells are feasible on quad-core desktop workstations; larger simulations are attainable on single HPC compute nodes. We demonstrate PhysiCell by simulating the impact of necrotic core biomechanics, 3-D geometry, and stochasticity on the dynamics of hanging drop tumor spheroids and ductal carcinoma in situ (DCIS) of the breast. We demonstrate stochastic motility, chemical and contact-based interaction of multiple cell types, and the extensibility of PhysiCell with examples in synthetic multicellular systems (a “cellular cargo delivery” system, with application to anti-cancer treatments), cancer heterogeneity, and cancer immunology. PhysiCell is a powerful multicellular systems simulator that will be continually improved with new capabilities and performance improvements. It also represents a significant independent code base for replicating results from other simulation platforms. The PhysiCell source code, examples, documentation, and support are available under the BSD license at [http://PhysiCell.MathCancer.org](http://physicell.mathcancer.org/) and [http://PhysiCell.sf.net](http://physicell.sf.net/).

## Author summary

This paper introduces PhysiCell: an open source, agent-based modeling framework for 3-D multicellular simulations. It includes a standard library of sub-models for cell fluid and solid volume changes, cycle progression, apoptosis, necrosis, mechanics, and motility. PhysiCell is directly coupled to a biotransport solver to simulate many diffusing substrates and cell-secreted signals. Each cell can dynamically update its phenotype based on its microenvironmental conditions. Users can customize or replace the included sub-models. PhysiCell runs on a variety of platforms (Linux, OSX, and Windows) with few software dependencies. Its computational cost scales linearly in the number of cells. It is feasible to simulate 500,000 cells on quad-core desktop workstations, and millions of cells on single HPC compute nodes. We demonstrate PhysiCell by simulating the impact of necrotic core biomechanics, 3-D geometry, and stochasticity on hanging drop tumor spheroids (HDS) and ductal carcinoma in situ (DCIS) of the breast. We demonstrate contact- and chemokine-based interactions among multiple cell types with examples in synthetic multicellular bioengineering, cancer heterogeneity, and cancer immunology. We developed PhysiCell to help the scientific community tackle multicellular systems biology problems involving many interacting cells in multi-substrate microenvironments. PhysiCell is also an independent, cross-platform codebase for replicating results from other simulators.

**Citation:** Ghaffarizadeh A, Heiland R, Friedman SH, Mumenthaler SM, Macklin P (2018) PhysiCell: An open source physics-based cell simulator for 3-D multicellular systems. PLoS Comput Biol 14(2): e1005991. https://doi.org/10.1371/journal.pcbi.1005991

**Editor:** Timothée Poisot, Universite de Montreal, CANADA

**Received:** September 27, 2016; **Accepted:** January 19, 2018; **Published:** February 23, 2018

**Copyright:** © 2018 Ghaffarizadeh et al. This is an open access article distributed under the terms of the [Creative Commons Attribution License](http://creativecommons.org/licenses/by/4.0/), which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.

**Data Availability:** The code and data will be publicly available at [http://PhysiCell.SourceForge.net](http://physicell.sourceforge.net/). High-resolution versions of the video files are available from both YouTube and figshare, at the links below: S1 Video ([https://www.youtube.com/watch?v=WMhYW9D4SqM](https://www.youtube.com/watch?v=WMhYW9D4SqM), [https://doi.org/10.6084/m9.figshare.5716600](https://doi.org/10.6084/m9.figshare.5716600)), S2 Video ([https://www.youtube.com/watch?v=xrOqqJ\_Exd4](https://www.youtube.com/watch?v=xrOqqJ_Exd4), [https://doi.org/10.6084/m9.figshare.5716597](https://doi.org/10.6084/m9.figshare.5716597)), S3 Video ([https://www.youtube.com/watch?v=ntVKOr9poro](https://www.youtube.com/watch?v=ntVKOr9poro), [https://doi.org/10.6084/m9.figshare.5716480](https://doi.org/10.6084/m9.figshare.5716480)), S4 Video ([https://www.youtube.com/watch?v=-lRot-dfwJk](https://www.youtube.com/watch?v=-lRot-dfwJk), [http://dx.doi.org/10.6084/m9.figshare.5721088.v1](http://dx.doi.org/10.6084/m9.figshare.5721088.v1)), S5 Video ([https://www.youtube.com/watch?v=NdjvXI\_x8uE](https://www.youtube.com/watch?v=NdjvXI_x8uE), [https://doi.org/10.6084/m9.figshare.5721136](https://doi.org/10.6084/m9.figshare.5721136)), S6 Video ([https://www.youtube.com/watch?v=wuDZ40jW\_\_M](https://www.youtube.com/watch?v=wuDZ40jW__M), [https://doi.org/10.6084/m9.figshare.5721145](https://doi.org/10.6084/m9.figshare.5721145)), S7 Video ([https://www.youtube.com/watch?v=bPDw6l4zkF0](https://www.youtube.com/watch?v=bPDw6l4zkF0), [https://doi.org/10.6084/m9.figshare.5721151](https://doi.org/10.6084/m9.figshare.5721151)), S8 Video ([https://www.youtube.com/watch?v=nJ2urSm4ilU](https://www.youtube.com/watch?v=nJ2urSm4ilU), [https://doi.org/10.6084/m9.figshare.5717887](https://doi.org/10.6084/m9.figshare.5717887)).

**Funding:** This work was funded by: USC Center for Applied Molecular Medicine: institutional support, no grant number, ([http://keck.usc.edu/applied-molecular-medicine-center/](http://keck.usc.edu/applied-molecular-medicine-center/)), USC James H. Zumberge Research and Innovation Fund (2012 Large Interdisciplinary Award): no grant number (URL: [http://research.usc.edu/for-investigators/funding/usc/zumberge/](http://research.usc.edu/for-investigators/funding/usc/zumberge/)), Breast Cancer Research Foundation: no grant number (URL: [http://bcrfcure.org](http://bcrfcure.org/)), Jayne Koskinas Ted Giovanis Foundation for Health and Policy: no grant number, (URL: [http://jktgfoundation.org/](http://jktgfoundation.org/)), National Cancer Institute: grants 5U54CA143907, 1R01CA180149 (URL: [https://www.nih.gov/](https://www.nih.gov/)), National Science Foundation: grant 1720625 (URL: [https://nsf.gov](https://nsf.gov/)). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.

**Competing interests:** Samuel H. Friedman was employed at Opto-Knowledge Systems, Inc. (OKSI) during the review and revision of the manuscript. This work was not funded, evaluated, approved, or owned in any manner by OKSI, and there are no competing interests in OKSI. Furthermore, OKSI has no patents, commercial products, products in development, or marketed products related to this work. The other authors have declared that no competing interests exist.

> This is a PLoS Computational Biology Software paper.

## Introduction

Many significant multicellular systems problems—such as tissue engineering, evolution in bacterial colonies, and tumor metastasis—can only be understood by studying how individual cells grow, divide, die, move, and interact \[[1](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref001)–[5](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref005)\]. Tissue-scale dynamics emerge as cells are influenced by biochemical and biophysical signals in the microenvironment, even as the cells continually remodel the microenvironment. Thus, the ideal “virtual laboratory” for multicellular systems biology must simultaneously simulate (1) tissue microenvironments with multiple diffusing chemical signals (e.g., oxygen, drugs, and signaling factors), and (2) the dynamics of many mechanically and biochemically interacting cells \[[5](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref005)\]. We recently published and open sourced the first part of such a platform: BioFVM, a biotransport solver that can efficiently simulate secretion, diffusion, uptake, and decay of multiple substrates in large 3-D microenvironments, even on desktop workstations \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\]. We now introduce and release as open source PhysiCell: a mechanistic off-lattice agent-based model that extends BioFVM to simulate the tissue-scale behaviors that emerge from basic biological and biophysical cell processes.

### Prior work

Several major computational frameworks are available for studying 3-D multicellular systems. CompuCell3D \[[7](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref007)\] and Morpheus \[[8](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref008)\] use Cellular Potts methods to simulate cells and their morphologies. They are very user-friendly packages with graphical model editors, integrated ODE and PDE solvers, and support for molecular-scale sub-models, but they currently cannot scale to large numbers (105 or more) of cells. TiSim (part of the CellSys package \[[9](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref009)\]) can simulate many more cells by using a cell-centered, off-lattice approach. However, it is currently closed source, and its executables are restricted to a limited set of simulation types. Chaste \[[10](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref010)\] is a powerful, well-developed framework for multicellular modeling with integrated PDE and ODE solvers, and both cell- and vertex-based simulations of 105 or more cells. However, its complex codebase has many dependencies that can impede participation by new developers; it is only cross-platform compatible by virtual machines. Biocellion \[[11](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref011)\] can simulate billions of cells on cluster computers, but it is closed source, and its restrictive user license has hindered adoption. Timothy was recently developed to simulate large-scale colonies of 109 cells on high-performance supercomputers \[[12](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref012), [13](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref013)\]. Most of these platforms offer a general-purpose pre-compiled “client” that can load models and settings from an XML file; this helps overcome difficulties stemming from complex dependencies. See [S1 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001) for a detailed software comparison.

These platforms typically require users to write their own code for all cell activities, by scripting basic built-in functions. (e.g., build a cell cycle model from API functions to overwrite cell volume and duplicate agents when appropriate.) As configured “out of the box,” none have built-in models for cell cycling, apoptosis, and necrosis, even though these fundamental behaviors are needed in many multicellular simulations. Only CompuCell3D and Morpheus have built-in volume regulation features. Most of these packages include PDE solvers that can simulate 3-D biotransport of one or more diffusible factors in the microenvironment, but generally they are applied sequentially to one PDE at a time, meaning that solving 10 PDEs requires 10 times more computational work than solving a single PDE. This approach is not expected to efficiently scale to 3-D simulations with many diffusible factors—a key requirement in reconciling secretomics with single-cell and multicellular systems biology, particularly as we work to understand cell-cell communication involving many cell-secreted factors.

### Scientific design goals and use cases

We aim to create a framework for building multicellular simulations that investigate the relationship between (diffusional) substrate limitations, multicellular biochemical communication, and essential phenotypic processes: cell cycling/division, death, volume changes, motility, adhesion, and volume exclusion/“repulsion” \[[1](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref001)\]. Building upon our experiences in agent-based modeling \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)–[16](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref016)\], we seek a system with a minimal set of mechanics to avoid cell lattice effects \[[2](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref002)\]; hence we use an off-lattice model with basic cell adhesion and “repulsion” implemented as simple potential functions \[[9](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref009), [10](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref010), [14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\]. Following our work in \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)–[16](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref016)\], we include basic models of gradual cell volume changes, rather than static cell volumes. This avoids non-physical “jumps” in cell velocity following cell division events: the sudden localized doubling of cell density causes cells to overlap, leading to large, temporary, and non-physical “repulsive” forces that can manifest as non-physical “tears” in simulated tissues.

While PhysiCell was originally developed for problems in cancer \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\], its diffusional and phenotypic processes are not specific to cancer. Users can introduce new environmental substrates (e.g., extracellular matrix (ECM) as a substrate with zero diffusion coefficient), new cell types (e.g., fibroblasts with high motility, low proliferation, and secretion and degradation of ECM), or new systems of cells (e.g., a network of vascular agents that release oxygen as in \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\], and that can divide and move along gradients of angiogenic growth factors). Modelers can also use PhysiCell’s core functions to create new libraries that simulate physiological systems, similar to how Microvessel Chaste \[[17](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref017)\] built upon the core functions of Chaste \[[10](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref010)\] to simulate new classes of problems in vascular remodeling. In **Additional PhysiCell examples**, we use PhysiCell’s basic building blocks to simulate synthetic multicellular systems, heterogeneous tumors, and the innate immune system as it interacts with tumor cells. As we continue to apply PhysiCell to our own work in tissue engineering, angiogenesis, microbial dynamics, and cancer, we plan to release new optional modules that introduce new capabilities and simplify modeling of _in vivo_ tissues and other systems. See [Availability and future directions](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#sec035).

Thus, PhysiCell is designed to be a general-purpose toolkit for exploring multicellular systems, and the multicellular behaviors that emerge from a user-implemented set of cell phenotypic rules (i.e., a set of hypotheses). Other potential uses include simulation-generated synthetic datasets that investigate the meaning and shortcomings of experimental measurements \[[18](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref018), [19](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref019)\]. PhysiCell’s design has allowed straightforward deployment on supercomputers for high-throughput simulation studies. We recently explored over 250 instances of a 3-D cancer-immune model (see **Additional PhysiCell examples**) to study the impact of immune cell motility and cancer-immune adhesion dynamics on a cancer immune response, thus reducing 1.5 years’ worth of simulations to 2 days on a Cray supercomputer \[[20](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref020), [21](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref021)\]. We anticipate that users can similarly use PhysiCell to efficiently explore large spaces of parameter values and hypotheses (model rules) with biophysically realistic, 3-D models. In Fall 2017, we started using PhysiCell in undergraduate and graduate education, as a self-contained tool for computational tissue engineering and cancer systems engineering. Lastly, PhysiCell also serves as an independent codebase to cross-validate model predictions in Chaste, Biocellion, TiSim, Timothy, and other platforms.

### Computational design goals

PhysiCell aims to balance computational speed, built-in standard functionality, flexibility, and codebase simplicity. It includes a built-in library of standardized cell cycle and cell death models co-developed with biologists and modelers here and in the MultiCellDS standardization process \[[22](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref022), [23](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref023)\], force-based cell-cell interaction mechanics, motility, and volume regulation. Users can replace any of these built-in models with their own, and they can dynamically assign custom functions to any agent at any time. Through BioFVM, PhysiCell can couple cell phenotype to many diffusible substrates. It is the only simulation package to explicitly model the cell’s fluid content—a key aspect in problems such as cryobiology \[[24](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref024)\]. It can simulate systems of 105\-106 cells on desktop workstations, and 106 or more cells on single HPC compute nodes. All this functionality and performance is achieved with only two external dependencies, and a fully cross-platform C++ codebase that we have compiled and tested on Linux, OSX, and Windows. We also distribute PhysiCell as a virtual appliance—with a full Linux desktop, 64-bit g++ compiler, and visualization tools—that can run in widespread virtual machine software like VirtualBox.

## Design and implementation

PhysiCell is designed to study the dynamics and interactions of thousands or millions of cells in 3-D microenvironments, with microenvironment-dependent phenotypes. It uses a lattice-free, physics-based approach to reduce grid-based artifacts. It provides optimized, biologically realistic functions for key cell behaviors, including: cell cycling (multiple models for _in vitro_ and _in vivo_\-focused simulations), cell death (apoptosis and necrosis), volume regulation (fluid and solid biomass; nuclear and cytoplasmic sub-volumes), motility, and cell-cell mechanical interactions. Each cell agent is built with a hierarchical Phenotype data structure; key phenotypic processes are triggered and controlled by modifying the phenotype data. This allows users to focus on modeling microenvironment-dependent triggers of standard cell processes, rather than coding these basic processes. However, to maintain flexibility, PhysiCell is written in a modular manner so that users can extend, rewrite, or replace its functions. Users can also create custom rules, and assign them to individual agents. It is fully coupled to a fast multi-substrate diffusion code (BioFVM) that solves for vectors of diffusing substrates, so that users can tie cell phenotype to many diffusing signals.

We note that for many problems in cancer biology and tissue engineering that drove development of PhysiCell, diffusive biotransport occurs at relatively fast time scales (on the order of 0.1 min or faster) compared to cell mechanics (∼ 1 min) and cell processes (∼ 10 to 100 min or slower). PhysiCell takes advantage of this by using three separate time step sizes (Δ_t_diff, Δ_t_mech, and Δ_t_cells). In particular, the cell phenotypes and arrangement (operating on slow time scales) can be treated as quasi-static when advancing the solution to the biotransport PDEs, so BioFVM can be called without modification with the cell arrangements fixed. See **Time steps** for further discussion. We provide default time step sizes that should suffice for typical applications in cancer biology and tissue engineering. Problems with inherently different time scales (e.g., advection-dominated problems, or with fast-moving bacteria) will need to adjust the time steps accordingly to avoid spurious oscillations that would be expected if cell-based sources and sinks are moving relatively quickly.

PhysiCell was built by extending the Basic\_Agent class in BioFVM \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\] (a static, non-moving object that can secrete and uptake substrates) into a fully dynamic Cell class with changing cell volume, cycle progression, death processes, motility, and mechanics. This allows the cells to directly and efficiently interface with the multi-substrate microenvironment. PhysiCell is written in cross-platform compatible C++ and is self-contained (with minimal dependencies). It can be compiled in any C++11 compiler with OpenMP support. This simplifies installation and improves the reproducibility of the experiments. We have tested PhysiCell on Windows through MinGW-w64, and on OSX and Linux via g++. (OSX users should note that Xcode does not include a compliant OpenMP-compatible g++; they should follow our tutorials for installing a compliant g++ via Homebrew or MacPorts. See [http://MathCancer.org/blog/physicell-tutorials/](http://mathcancer.org/blog/physicell-tutorials/).) PhysiCell’s only external dependencies are pugixml \[[25](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref025)\] (for XML parsing) and BioFVM \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\] for 3-D multi-substrate diffusion. For the user’s convenience, compatible versions of pugixml and BioFVM are included in every download.

The code has been parallelized in OpenMP to make use of multi-core desktop workstations and single HPC compute nodes. In testing, its performance (the computational time to simulate a fixed amount of time on a fixed domain) scales linearly in the number of cells present in the simulation. Simulations of up to 106 cells are feasible on desktop workstations, and simulations beyond 106 cells are possible on typical HPC compute nodes.

### Overall program flow

After initializing the microenvironment (through BioFVM \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\]) and cells, and initializing the current simulation time _t_ = 0, PhysiCell tracks (internally) _t_mech (the next time at which cell mechanics functions are run), _t_cells (the next time at which cell processes are run), and _t_save (the next simulation data output time), with output frequency Δ_t_save. Initially, we set: ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e001)(1) PhysiCell repeats the main program loop until reaching the maximum simulation time:

1.  Save the simulation state if _t_ ≥ _t_save. Set _t_save = _t_save + Δ_t_save.
2.  Run BioFVM to update the biochemical microenvironment for cell-based secretions and uptake, and reaction-diffusion, for the current fixed cell positions. See **Biochemical microenvironment**.
3.  For the fixed cell positions and chemical substrate fields, if _t_ ≥ _t_cells, run the cell processes for each cell:  
    
    1.  Update cell parameters using the cell’s update\_phenotype functions. See **Cell characteristics and state**.
    2.  Advance the cell cycle (or death) model. See **Cell cycling** and **Cell death**.
    3.  Advance the cell’s volume (and sub-volumes) using the volume\_update\_function. See **Cell volume**.
    
    Then set _t_cells = _t_cells + Δ_t_cells.
4.  If _t_ ≥ _t_mech, then:  
    
    1.  For each cell, calculate the force-based cell velocities via update\_velocity, add the contribution of motility (which runs update\_migration\_bias as needed), and run the custom function custom\_cell\_rule. See **Cell motility** and **Cell mechanics and motion**.
    2.  For each cell, update the position using the Adams-Bashforth method. See **Cell mechanics and motion**.
    
    Set _t_mech = _t_mech + Δ_t_mech.
5.  Update the current simulation time by _t_ = _t_ + Δ_t_diff. Return to Step 1.

Steps 3a-c can be combined in a parallelized OpenMP loop; we flag cells for division and removal and process these queues serially after the parallel loop to avoid data corruption. Step 4a can be parallelized across the cells by OpenMP (because cell velocities are location-dependent, and the cell positions are fixed throughout 4a), and then Step 4b can be parallelized across the cells with these computed velocities.

### Biochemical microenvironment

We use BioFVM to simulate the chemical microenvironment with a vector of reaction-diffusion PDEs with both bulk source/sinks and cell-centered sources and sinks \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\]. To briefly summarize that prior work, we model the biochemical microenvironment (with computational domain Ω and boundary ∂Ω, discretized as a Cartesian mesh for computational efficiency) as a vector of reaction-diffusion PDEs for a vector of chemical substrates **_ρ_** of the form ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e002)(2) with zero flux conditions on ∂Ω. Here, _δ_(**x**) is the Dirac delta function, **x**_k_ is the _k__th_ cell’s position, _W__k_ is its volume, **S**_k_ is its vector of source rates, **U**_k_ is its vector of uptake rates, and **_ρ_**\* is the vector of saturation densities (the densities at which the cells stop secreting). Likewise, **D** and **λ** are the vectors of diffusion coefficients and decay rates, **S** is the bulk supply rate, and **U** is the bulk uptake function. All vector-vector products **ab** are element-wise (Hadamard product).

Numerically, we solve for the solution at time _t_ + Δ_t_diff by a first-order operator splitting: we first solve the bulk source/sink terms across the domain (and overwrite the stored solution), then solve the cell-centered source/sink terms (and overwrite the solution), and then the reaction-diffusion terms (again, overwriting the stored solutions). As we detailed and verified in \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\], because we used (numerically stable) first-order backward differences in all our time discretizations, the overall method is first-order accurate in time and numerically stable.

After this operator splitting, the bulk source/sink terms are a decoupled set of systems of ODEs (one vector of ODEs in each computational voxel), which we solve by the backwards Euler method for first-order accuracy and numerical stability. This is trivially parallelized by OpenMP by dividing the voxels across the processor cores. Similarly, we solve the cell-based source/sink equations (one system of ODEs per cell) by backwards-Euler, overwriting the solution in the voxel containing the cell’s center. As we showed in \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\], this is first-order accurate and numerically stable, and it performs best when the computational voxels are comparable to the cells’ sizes or larger. In all our work, we satisfy this requirement by using 20 _μ_m voxels. As with the bulk source/sinks, we trivially parallelize by dividing the cell source/sinks (one system of ODEs per cell) across the processor cores with OpenMP.

To solve the vector of diffusion-decay PDEs, we use the locally one-dimensional method: a specialized operator splitting that turns the 3-D PDEs into a sequence of one-dimensional PDEs. In each _x_\-strip, _y_\-strip, or _z_\-strip, we discretize the PDEs with second-order centered differences (spatial derivatives) and first-order backwards differences (time derivatives) to obtain a tridiagonal linear system in each strip, which we solve exactly with a tailored Thomas solver. The Thomas solver itself cannot be trivially parallelized, but because we have many simultaneous _x_\-, _y_\-, and _z_\-strips, we can distribute many instances of the Thomas solver across processor cores by OpenMP. This technique, along with other optimizations (tailored overloaded vector operators, a vectorized Thomas solver, pre-computing and caching the forward sweeps of the Thomas solvers, and other similar optimizations) was tested to scale linearly in the number of substrates (number of PDEs), the number of computational voxels, and the number of discrete cell sources/sinks. The method was numerically stable even for large Δ_t_, first-order accurate in time, and second-order accurate in space. Simulating 10 PDEs on 1,000,000 voxels takes approximately 2.6 times more computational time than simulating a single PDE. We found that for typical magnitudes of **D**, **S**, **U**, and **λ**, using Δ_t_diff = 0.01 min and Δ_x_ = 20 _μ_m gave solutions with 5% relative accuracy or better. For more algorithmic detail and extensive convergence testing on a variety of problems, see \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\] and its supplementary material.

### Agent-based cell model

PhysiCell implements key cell-scale processes—cell cycling and death, volume changes, mechanics, and motility—and lets users link the parameters of these processes to microenvironmental conditions. PhysiCell then scales these basic cell-scale hypotheses to simulate thousands or millions of cells, from which tissue-scale behavior emerges. Here, we summarize the key functions. For each sub-model, see [S1 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001) for the full equations, further biological motivation, and reference parameter values.

#### Cell characteristics and state.

Cell agents have a variety of phenotypic properties, including position (**x**_i_), volume (and sub-volumes), cell cycle or death status, and mechanics (adhesive, deformation, and motility) parameters. Each cell has a hierarchically-structured, independent Phenotype object that organizes information on cell cycling, death, volume, geometry, mechanics, motility, and secretion. Each cell also has an independent Cell\_Functions object that collects functions to update cell volume, motility, velocity (mechanics), and other properties. See the User Guide ([S2 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s002), included in every PhysiCell download Version 1.2.0 or later) for a list of all the cell agents’ attributes and functions to access/update them. Below, we describe standardized, built-in models to update these properties. The models can be replaced by user-defined functions; the supplied models serve as biophysically reasonable default functions that capture the key aspects of these processes.

#### Cell volume.

Each cell tracks _V_ (total volume), _V_F (total fluid volume), _V_S (total solid volume), _V_NS (nuclear solid volume), _V_CS (cytoplasmic solid volume), _V_N (total nuclear volume), and _V_C (total cytoplasmic volume). Key parameters include nuclear solid, cytoplasmic solid, and fluid rate change parameters (_r_N, _r_C, and _r_F), the cell’s “target” fluid fraction _f_F, target solid volume ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e003), and target cytoplasmic to nuclear volume ratio _f_CN. For each cell, these volumes are modeled with a system of ODEs: ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e004)(3) ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e005)(4) ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e006)(5) where we use the constitutive laws ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e007)(6) ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e008)(7) These parameters are updated as the cell progresses through its current cycle or death process. (See **Cell cycling** and **Cell death**.) For example, we halve ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e009) after a cell division and double it upon re-entry to the cell cycle. We set ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e010) at the onset of apoptosis, and we set _r_F, _r_C, and _r_N based on key apoptosis time scales. See [S1 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001) for the full equations, sample solution plots, further biological motivation, convergence testing, and reference parameter values. These ODEs are numerically solved using first-order forward Euler discretizations.

#### Cell motility.

Each cell can set its own persistence time (_T_per), migration speed (_s_mot), migration bias direction (**d**bias, a unit vector), and a migration bias _b_ that ranges from 0 (Brownian motion) to 1 (deterministic motion along **d**bias). When updating the cell’s velocity, its migration velocity **v**mot is added to the currently velocity (as calculated by mechanics; see **Cell mechanics and motion**). The cell changes its migration velocity stochastically between _t_ and _t_ + Δ_t_mech with probability ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e011)(8) The user-defined function update\_migration\_bias (see the User Guide [S2](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s002) and [S1](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001) Text) sets **v**bias, _b_, and _s_mot. The migration velocity **v**mot is then updated according to ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e012)(9) where **_ξ_** is a random unit vector. See the user manual ([S2 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s002)) and [S1 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001) for more details, as well as examples for biased migration along chemical gradients.

#### Cell mechanics and motion.

We model cell mechanics and motion as in our prior work \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\]: we update each cell’s position **x**_i_ by calculating its current velocity **v**_i_ based upon the balance of forces acting upon it. The main forces include cell motility, drag-like forces, and cell-cell and cell-matrix interaction forces: adhesion and “repulsion” (resistance to deformation and/or volume exclusion \[[26](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref026)\]). As in prior cell-centered models \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014), [27](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref027), [28](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref028)\], we apply an inertialess assumption (![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e013)) to explicitly solve for each cell’s velocity. As before \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\], we model adhesion and repulsion with interaction potentials that depend upon each cell’s size, maximum adhesion distance, adhesion and repulsion parameters, and distance to other cells. The cell’s velocity **v**_i_ is given by ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e014)(10) where as in \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\], _ϕ__n_,_R_(**x**) is an adhesion interaction potential function which is zero for ‖**x**‖ > _R_, and approaches zero with smoothness given by _n_. Similarly, _ψ__n_,_R_(**x**) is a repulsion interaction potential function that is zero for ‖**x**‖ > _R_. Thus, cell-cell mechanical interactions occur over finite distances. Here, ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e015) and ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e016) are the _i__th_ cell’s cell-cell adhesion and repulsion parameters, _R__i_ is its radius, and _R__i_,_A_ is its maximum adhesion distance (typically a fixed multiple of _R__i_). Note that if cell _i_ and _j_ have identical cell-cell adhesion and repulsion parameters _c_cca and _c_ccr, then the cell-cell interaction coefficients simplify to the form we published in \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\]; otherwise, this is a phenomenologic form that allows either cell’s coefficient to affect the cell-cell interaction strength, with equal and opposite effect on both cells. We plan future improvements to move beyond the current phenomenologic forms to more mechanistic models.

Also, _d_(**x**) is the distance to the nearest basement membrane (if any), **n**(**x**) is a unit vector normal to the basement membrane, and so −_d_(**x**_i_)**n**(**x**_i_) points from the cell’s position **x**_i_ to the nearest point on the basement membrane, located at **x**_i_ − _d_(**x**_i_)**n**(**x**_i_). (See \[[29](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref029)–[31](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref031)\] for more information on level set (distance function) representations of surfaces, there applied to tumor growth models.) ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e017) is the (finite) list of cells that could potentially interact with cell _i_. (See **Key code optimizations**.) Further references and the full forms of the potential functions are given in [S1 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001).

The cell’s position is updated using the second-order Adam’s Bashforth discretization: ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e018)(11)

#### Cell cycling.

PhysiCell includes a cell cycle modeling framework, where each cell cycle model is a collection of phases {_X__i_}, transition rates {_r__ij_} between the phases, and a cell division phase transition. As of Version 1.2.0, users can also set phase entry and exit functions (associated with the phases _X__i_) that are executed at entry into or exit from the phase; these can be used to model processes such as mutation of cell parameters. The framework also allows users to set arrest functions (associated with the transition rates _r__ij_) that block the transition. This is useful for modeling effects like volume restrictions. See the User Guide ([S2 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s002)) for full details. As in \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\], we use the phase transition rates to calculate the phase change probabilities in any time interval \[_t_, _t_ + Δ_t_\]: the probability of transitioning from phase _X__i_ to phase _X__j_ in this time interval is given by ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e019)(12)

Users can set individual transitions _r__ij_ to have deterministic duration, with duration 1/_r__ij_. See the User Guide ([S2 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s002)) for full details.

Each cell agent tracks its current cell cycle phase ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e020) and its total time spent in that phase (_t__k_). Users can change the transition rates at any time, in part based upon microenvironmental conditions (e.g., based upon oxygenation or cell contact).

As a concrete example, consider the “Ki67 Advanced” model from our prior work calibrating oxygen-dependent growth to Ki67 data in ductal carcinoma in situ (DCIS) \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014), [15](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref015), [32](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref032)\]. The phases are _K_1 (Ki67+ cycling cells, prior to cell division), _K_2 (Ki67+ cycling cells, after cell division), and _Q_ (Ki67- quiescent cells). _K_1 and _K_2 have stochastic durations (with means _T_1 and _T_2). We model the transition rate from _Q_ to _K_1 as ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e021)(13) where cells spend a mean time of ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e022) in the _Q_ phase when ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e023). Cells double ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e024) when transitioning from _Q_ to _K_1 (to double their nuclear content), and they halve ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e025) (and all the sub-volumes) when dividing into two daughter cells at the _K_1 → _K_2 transition. The full set of supported cell cycle models—along with reference parameter values—is given in [S1 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001).

#### Cell death.

PhysiCell currently includes models for two types of cell death: apoptosis (programmed cell death) and necrosis (unprogrammed cell death) \[[33](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref033)\]. At any time, each agent (with index _i_) has two death rates (_r_A,_i_ for apoptosis, and _r_N,_i_ for necrosis), which can be continually updated. For any death rate _r__i_ and any time interval \[_t_, _t_ + Δ_t_\], the cell has a probability of entering the corresponding death state _D__i_: ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e026)(14) Apoptosis: Upon entering the apoptotic state, we set _f_CN = 0 (to simulate shrinking and blebbing of the cytoplasm), ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e027) (to simulate degradation of the nucleus), and _f_F = 0 (to simulate the active elimination of water from the cell). The rates _r_N, _r_F, and _r_C are set to match time scales of cell volume loss in apoptotic cells. The cell is removed once its volume drops below a user-set threshold, or after mean duration of _T_A.

Necrosis: When a cell becomes necrotic, we set ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e028) to model cytoplasmic and nuclear degradation. Early necrotic cells undergo oncosis (cell death-related swelling); we model this by setting _f_F = 1. (Note that some regard oncosis as the actual death process, and necrosis as post-mortem cell degradation \[[34](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref034), [35](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref035)\].) Once the cell volume passes a critical threshold, it lyses, and we set _f_F = 0. The rate parameters _r_F, _r_N, and _r_C are set to match expected time scales throughout necrosis \[[33](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref033)\]. PhysiCell includes codes to trigger necrosis deterministically or stochastically:

Deterministic Necrosis: This implements a common model of necrosis (see the review \[[2](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref002)\]), where cells instantly become necrotic whenever oxygenation pO2 drops below a threshold value pO2,threshold, as in our earlier work \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\]. This is equivalent to the letting _r_N → ∞.

Stochastic Necrosis: This model updates our prior work \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\], based upon _in vitro_ observations that cells can survive low oxygen conditions for hours or days. Here, ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e029)(15) That is, necrotic death begins when pO2 < pO2,threshold, and the death rate ramps linearly until saturating at a maximum rate _r_N,max for pO2 < pO2,crit. Equivalently, cells survive on average 1/_r_N,max time in very low oxygen conditions \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\].

### Numerical implementation

#### Time steps.

PhysiCell has three time steps to model (fast) diffusive biotransport processes (Δ_t_diff; default 0.01 min), cell movement (Δ_t_mech; default 0.1 min), and (relatively slow) cell processes (Δ_t_cells; default 6 min). We use these time steps to set how frequently biotransport processes, cell movement processes, and cell phenotype processes are updated. See [Fig 1](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g001).

[![thumbnail](https://journals.plos.org/ploscompbiol/article/figure/image?size=inline&id=info:doi/10.1371/journal.pcbi.1005991.g001)](https://journals.plos.org/ploscompbiol/article/figure/image?size=medium&id=info:doi/10.1371/journal.pcbi.1005991.g001 "Click for larger image")

Fig 1. PhysiCell and multiple time scales.

PhysiCell uses BioFVM to update the microenvironment at the short green tick marks, corresponding to Δ_t_diff. It updates cell mechanics (including cell position) less frequently at the medium black tick marks (Δ_t_mech), and it runs the cell volume and cycle/death models least frequently at the long red tick marks (Δ_t_cell). Note that the time steps shown are for illustrative purpose; the default step sizes are given in **Time steps**.

[https://doi.org/10.1371/journal.pcbi.1005991.g001](https://doi.org/10.1371/journal.pcbi.1005991.g001)

The default Δ_t_diff was chosen for diffusion, decay, and uptake/secretion parameter values typical for the cancer and tissue engineering problems that drove PhysiCell’s development. In prior testing, relative errors did not exceed 5% for this value \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\]. In mechanical relaxation tests for overlapping cells and compressed tumor spheroids, we found that Δ_t_mech = 0.1 min gave solutions that converged at first-to-second order accuracy, had relative errors 5% or less, and avoided spurious oscillations and other artifacts for cell velocities under ∼ 1 _μ_m/min (typical for cancer biology problems); see [S1 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001). The cell cycle, death, and volume change models were numerically stable and first-order accurate with relative errors of 5% or less for Δ_t_cells = 6 min. See [S1 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001). Users should reduce Δ_t_cells for problems with faster phenotypic processes. Users anticipating faster cell movement (e.g., motile bacteria) should reduce Δ_t_mech. We recommend setting ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e030).

Mathematically, this time scale separation allows us to hold cell positions fixed (quasi-static) when updating the PDE solutions, and then hold the chemical fields fixed when updating cell positions and phenotypes. We have used similar techniques in nonlinear continuum models of tumor growth (slow time scale) in heterogeneous biochemical microenvironments (fast time scale) \[[29](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref029)–[31](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref031)\].

#### Estimated computational cost scaling.

We now assess the computational effort needed for each iteration in the main program loop. (See **Overall program flow**.) Step 1 (save simulation data), Step 3 (run cell processes), and Step 4b (update positions) clearly entail a constant amount of work for each cell. Thus, summing these steps over all cells _n_(_t_) requires ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e031) work. By prior analysis, BioFVM (Step 2) also scales linearly in _n_(_t_) \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\].

Step 4a (update velocities) is the most computationally expensive step. In straightforward implementations, each cell tests for mechanical interaction with _n_ − 1 other cells, giving an ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e032) total computational cost at each time step. However, the interaction data structure (see **Key code optimizations**) restricts interaction testing to a smaller set ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e033).

In **Expanded computational cost estimates**, we show that each ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e034) has at most _N_max cells. Thus, Step 4b has a fixed maximum cost for each cell, and the cost of the loop scales linearly in _n_.

#### Key code optimizations.

To prevent computational costs from scaling quadratically in the number of cells, we designed a cell-cell interaction data structure (IDS) that efficiently estimates a set ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e035) of possible neighbor cells for each cell agent. See [S1 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001) for further detail.

PhysiCell uses OpenMP to parallelize most loops over the list of cells. This includes sampling the microenvironment, updating cell phenotype parameters, advancing the cell cycle or death model, advancing the volume model, running any custom function, and calculating the cell velocity. We do not parallelize loops that change the IDS: cell division, cell removal, and updating the cell position.

As discussed above, we defined three separate computational step sizes (Δ_t_diff < Δ_t_mech < Δ_t_cells) to take advantage of the multiple time scales of the multicellular system. As indicated in the overall program flow above, we update each process according to its own time step, rather than at each simulation step. [Fig 1](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g001) further illustrates how the multiple times steps reduce the computational cost. See [S1 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001) for further detail and the default step sizes for cancer biology and tissue engineering.

#### Expanded computational cost estimates.

Most of the simulation steps have computational cost that scales linearly in the number of cells. (See **Estimated computational cost scaling**.) The step that requires additional analysis (and relies upon PhysiCell’s IDS) is the step where cell-cell mechanical interactions are used to set the cell velocities. Bounding this computational costs requires that we find a fixed upper bound on the number of cell-cell interactions, so that the computational cost is ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e036) for single cells, and ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e037) for all the cells.

We estimate an upper bound on the of cells in any voxel _B__i_ by ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e038)(16) where _V_mech is the fixed volume of the voxels in the interaction testing data structure. For cycling cells with “mature” volume _V_, we have ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e039). By default, dead cells are removed when ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e040). Since a typical ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e041) is constructed from up to 27 such voxels, we have ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e042)(17) for simulations dominated by live cells, and ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e043)(18) for simulations dominated by dead cells. Thus, the computational cost for a single cell’s mechanical interactions is bounded by a fixed constant, and the total cost over all cell-cell mechanical interactions scales linearly in _n_. The slope of the cost-versus-_n_ curve may be shallower for early, non-necrotic simulations, and it can be up to a factor of 100 steeper for necrosis-dominated simulations. In some cases, simulations may temporarily show a nonlinear relationship with _n_ when transitioning from non-necrotic to necrotic.

### Convergence and validation testing

We performed convergence testing on all the major components of PhysiCell. BioFVM was previously tested as first-order accurate in Δ_t_, second-order accurate in Δ_x_, and sufficiently accurate at Δ_x_ = 20 _μ_m and Δ_t_diff = 0.01 to 0.05 min for tumor growth problems \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\]. We performed two tests for cell-cell mechanics and motion: First, we placed two cells in partial overlap, simulated their relaxation to equilibrium, and measured the cell spacing at several times. Second, we created a compressed cluster of 50,000 cells, simulated its mechanical relaxation to equilibrium, and measured its diameter at several times. Both tests converged to first-order accuracy in Δ_t_ at all measured times, showing that PhysiCell converged in both short-time mechanical dynamics and in long-time behavior. Δ_t_mech ∼ 0.1 min gives sufficient accuracy for typical cancer problems.

We simulated the volume model for a single proliferating, apoptotic, and necrotic cell, and measured the sub-volumes at multiple times. It converged with first-order accuracy in Δ_t_ at all tested times, and Δ_t_cell = 6 min gave sufficient accuracy. We tested the stochastic transition codes by simulating the Ki67-advanced cell cycle model and the apoptosis death model (with stochastic duration), and measuring the sub-population counts and population fractions over time for several values of Δ_t_cell. For each Δ_t_, we performed 100 simulations and compared the mean solution behavior against known coarse-grained ODE model behavior. Δ_t_cell = 6 min and 60 min both gave an excellent match between the PhysiCell behavior and theory for all the compared curves. See [S1 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001) for full testing results.

### Performance testing (summary)

By our testing, recent quad-core desktop workstations (with hyperthreading, for 8 total execution threads) can simulate 10-30 days in systems of up to 105 to 106 cells in 3 days or less (wall time). Single HPC compute nodes (typically two 6-8 core processors, with hyperthreading and 24-32 execution threads) can simulate larger systems up to ∼ 2 million cells in about 2 days. Future releases of PhysiCell will address current performance bottlenecks; see [Availability and future directions](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#sec035). The [Results](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#sec022) will give a demonstration of ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e044) computational cost scaling.

## Results

We demonstrated PhysiCell’s potential to simulate large multicellular systems—and its ability to test the emergent tissue-scale effects of cell-scale hypotheses—on several examples arising from cancer biology and synthetic multicellular systems bioengineering. For the first two examples, we compared the impact of the deterministic and stochastic necrosis models. (See **Cell death** above.) We used the Ki67-advanced cell cycle model with deterministic _K_1, _K_2, and _A_ phase durations for the first two examples. (See **Cell cycling**.) We used a simpler “live cells” cycle model \[[22](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref022)\] in the remaining examples, where live cells proliferate with a variable birthrate, apoptose, or necrose. We provide detailed parameter values in [S1 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s001) for the HDS and DCIS examples, and the full source code and postprocessing routines for both examples in every PhysiCell download. Full source code and simple build instructions are provided for the remaining examples. Reference simulation outputs for the first two examples are available at [http://PhysiCell.MathCancer.org](http://physicell.mathcancer.org/).

### Test platforms

The **Hanging drop tumor spheroids** and **Ductal carcinoma in situ (DCIS)** examples were tested on (1) a desktop workstation (quad-core Intel i7-4790, 3.60 GHz, 8 execution threads, 16 GB memory) with mingw-w64 (g++ ver. 4.9.1) on 64-bit Windows 7, and (2) a single HPC compute node (dual 6-core Intel Xeon X5690, 3.47 GHz, 24 execution threads, 48 GB memory) with g++ (ver. 4.8.4) on Ubuntu 14.04. The tests were performed using PhysiCell 1.0.0, although release 1.2.0 has updated the tests for compatibility. The CPU architecture was newer on the desktop (2014 Haswell) than on the HPC node (2011 Westmere). The newer **“Biorobots”**, **Anti-cancer biorobots**, **Cancer heterogeneity and immune response**, and **Adding an immune response** examples were tested on a quad-core Intel i7-4770K, 4.06 GHz, 8 execution threads, 32 GB memory, using PhysiCell Version 1.2.1 with g++ 7.1.0 on 64-bit Windows 10 (via MinGW-w64).

### Hanging drop tumor spheroids

Hanging drop spheroids (HDS)—a 3-D cell culture model where a small cluster or aggregate of tumor cells is suspended in a drop of growth medium by surface tension—are increasingly used to approximate 3-D _in vivo_ growth conditions \[[36](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref036)\]. Unlike traditional 2-D monolayer experiments, HDSs allow scientists to investigate the impact of substrate gradients on tumor growth, particularly oxygen gradients. Their relatively simple geometry makes them ideal for testing computational models.

We simulated HDS growth by placing an initial cluster of ∼ 2300 cells in an 8 mm3 fluid domain, with Dirichlet conditions pO2 = 38 mmHg (5% oxygen: physioxic conditions \[[37](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref037)\]) on the computational boundary. The simulation results are shown in [Fig 2](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g002) for deterministic necrosis (left column) and stochastic necrosis (right column), at 4, 8, and 16 days. In [Fig 3](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g003), we show the tumor diameter (left panel) and number of agents (right panel) versus time. Both simulations reached ∼ 106 cells by 18 days. See the simulation videos [S1](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s004) and [S2](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s005) Videos.

[![thumbnail](https://journals.plos.org/ploscompbiol/article/figure/image?size=inline&id=info:doi/10.1371/journal.pcbi.1005991.g002)](https://journals.plos.org/ploscompbiol/article/figure/image?size=medium&id=info:doi/10.1371/journal.pcbi.1005991.g002 "Click for larger image")

Fig 2. Hanging drop spheroid (HDS) simulations with deterministic necrosis (left) and stochastic necrosis (right), plotted at 4, 8, and 16 days.

Videos are available at [S1](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s004) and [S2](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s005) Videos. _**Legend:**_ Ki67+ cells are green before mitosis (_K_1) and magenta afterwards (_K_2). Pale blue cells are Ki67- (_Q_), dead cells are red (apoptotic) and brown (necrotic), and nuclei are dark blue. _**Bottom:**_ Hanging drop spheroid experiment (HCC827 non-small cell lung carcinoma) showing a similar necrotic core microstructure. PhysiCell is the first simulation to predict this structure arising from cell-scale mechanical interactions. Image courtesy Mumenthaler lab, Lawrence J. Ellison Center for Transformative Medicine, University of Southern California.

[https://doi.org/10.1371/journal.pcbi.1005991.g002](https://doi.org/10.1371/journal.pcbi.1005991.g002)

[![thumbnail](https://journals.plos.org/ploscompbiol/article/figure/image?size=inline&id=info:doi/10.1371/journal.pcbi.1005991.g003)](https://journals.plos.org/ploscompbiol/article/figure/image?size=medium&id=info:doi/10.1371/journal.pcbi.1005991.g003 "Click for larger image")

Fig 3. HDS growth.

_**Left:**_ The deterministic and stochastic necrosis models both give approximately linear growth (left), but the HDS with deterministic necrosis model grows faster (∼ 5% difference in diameter at day 18). _**Right:**_ The HDS with stochastic necrosis has fewer cells than the deterministic model (∼ 26% difference in cell count at day 18), due to its delay in necrosis. The difference in cell count is larger than the difference in tumor diameter because most of the difference lies in the number of necrotic cells, and necrotic cells are smaller than viable cells.

[https://doi.org/10.1371/journal.pcbi.1005991.g003](https://doi.org/10.1371/journal.pcbi.1005991.g003)

#### Deterministic versus stochastic necrosis.

Both models yielded similar dynamics. Hypoxic gradients emerged quickly, limiting (pO2\-dependent) cell division to the outermost portions of the tumors. This, in turn, lead the tumor diameters to grow linearly (at similar rates); see [Fig 3](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g003). This matches our theoretical expectations for a spheroid of radius _R_(_t_) whose growth is restricted to an outer layer of fixed thickness _T_: ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e045)(19) ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e046)(20)

In both models, the innermost portion of the necrotic core developed a network of fluid voids or cracks. This phenomenon emerges from competing biophysical effects of the multicellular system and its cell-scale mechanical details: necrotic cells lose volume, even as they continue to adhere, leading to the formation of cracks. To our knowledge, this is the only model that has predicted this necrotic tumor microarchitecture, which would be very difficult to simulate by continuum methods except with very high-resolution meshes comparable to the ∼ 1 to 10 _μ_m feature size. These cracked necrotic core structures have been observed with _in vitro_ hanging drop spheroids (e.g., \[[5](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref005), [38](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref038), [39](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref039)\]). See [Fig 2](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g002).

There were notable differences between the models. The deterministic model had a sharp perinecrotic boundary between the viable and necrotic tissues, whereas the stochastic model demonstrated a perinecrotic transition zone with substantial mixing of viable and necrotic cells. Because cells do not immediately necrose in the stochastic model, it retained a center of quiescent viable cells longer than the deterministic model. The growth curves for the deterministic and stochastic models appear to diverge after approximately 8 days, when the deterministic necrotic core is better defined with more cracks than the stochastic core. This may be due to differences in hypoxic gradients (the tumor with more void spaces will have shallower oxygen gradients, and hence more cell cycle entry), but further simulations would be required to rule out stochastic effects. Interestingly, the stochastic model’s growth curve appears to run parallel to the deterministic curve for later times, once its necrotic core becomes better defined.

#### Performance scaling.

Throughout the simulations, the computational cost (the wall time required to simulate one hour) scaled approximately linearly with the number of agents present in the simulation, on both the desktop workstation and the HPC node; see [Fig 4](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g004). (See also **Estimated computational cost scaling**.) Increasing the number of execution threads improved performance, even when running on slower processor cores. See the right panel in [Fig 4](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g004), where moving from the newer 8-threaded machine to the older 24-threaded machine improved performance by a factor of 2 to 2.5.

[![thumbnail](https://journals.plos.org/ploscompbiol/article/figure/image?size=inline&id=info:doi/10.1371/journal.pcbi.1005991.g004)](https://journals.plos.org/ploscompbiol/article/figure/image?size=medium&id=info:doi/10.1371/journal.pcbi.1005991.g004 "Click for larger image")

Fig 4. HDS computational cost scaling.

_**Left:**_ Wall-time vs. cell count for the stochastic (red) and deterministic (blue) necrosis necrosis models on a single HPC compute node. Both models show approximately linear cost scaling with the number of cell agents. _**Right:**_ Wall time vs. cell count for stochastic necrosis model on the desktop workstation (orange) and the single HPC node (green).

[https://doi.org/10.1371/journal.pcbi.1005991.g004](https://doi.org/10.1371/journal.pcbi.1005991.g004)

The simulations reached ∼ 106 cells on our HPC tests after 67 hours (deterministic, 17 simulated days) to 76 hours (stochastic, 18.2 simulated days) of wall time, including saving full simulation output data once per simulated hour. See [Fig 3](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g003). The desktop workstation simulated past 573,000 cells (about 14.6 days of simulated time) in approximately 80 hours of wall time. The desktop tests did not run out of memory, and the simulations can be completed to the full 18 days and 106 cells if needed.

### Ductal carcinoma in situ (DCIS)

DCIS is a pre-malignant breast condition where epithelial cells (“tumor cells”) divide abnormally to fill the breast duct lumen. Oxygen can only reach the tumor cells by diffusion from outside the duct, leading to the emergence of hypoxia and an inner necrotic core. See \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014), [15](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref015), [32](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref032)\] for further biological and clinical discussion. As in \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\], we approximate a partly-filled breast duct as a 3-D “test tube” with a level set function representation. Cells adhere to cells and the duct wall; cells and the duct wall push against cells to resist deformation. Oxygen diffuses from the duct wall and is consumed by tumor cells. The rate of cycle entry increases linearly with pO2 (see **Cell cycling**).

In [Fig 5](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g005), we show DCIS simulations in a 1 mm segment of breast duct (317.5 _μ_m diameter), using deterministic necrosis (left side) and stochastic necrosis (right side), plotted at 10 and 30 days. See also [S3](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s006) and [S4](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s007) Videos. As in prior work \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\], the simulations predict cell-scale details observed in DCIS pathology, such as the appearance of pairs of Ki67+ daughter cells, the spatially isolated apoptotic cells (which arises from the model assumption that apoptosis is a stochastic, low-frequency event that is independent of oxygenation), and the higher occurrence of Ki67+ cells near the duct wall (where we modeled the probability of cell cycle entry as proportional to oxygenation).

#### Comparison of necrosis models; comparison with the spheroid example.

As in the HDS example, the deterministic model had a sharp, smooth perinecrotic boundary, whereas the stochastic model demonstrated a perinecrotic boundary region with mixed viable and necrotic cells. In the stochastic model, proliferation halted in the duct center, but necrosis appeared later. The perinecrotic mixing effect was most pronounced at the leading edge of the tumor, where tissue was transitioning from non-hypoxic/non-necrotic to necrotic. Areas with longer-term hypoxia had smoother necrotic boundaries. This effect did not emerge in the HDS example due to its symmetry.

Interestingly, the mechanical “cracks” seen in the tumor spheroids do not appear here, because the breast duct compresses the necrotic core to collapse any fluid-filled voids. This shows the importance of the 3-D geometry and the biophysical impact of the basement membrane, as well as the need to account for such effects when approximating _in vivo_ conditions with bioengineered model systems.

Both models gave approximately the same growth rate of ∼ 1 cm/year ([Fig 6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g006), left). We cannot select one model over the other based solely upon continuum-scale, coarse-grained outputs. However, we could further assess the models by comparing their distinct differences in multicellular-scale patterning to DCIS pathology. This further highlights the need and potential for multicellular modeling in evaluating cell-scale hypotheses.

[![thumbnail](https://journals.plos.org/ploscompbiol/article/figure/image?size=inline&id=info:doi/10.1371/journal.pcbi.1005991.g006)](https://journals.plos.org/ploscompbiol/article/figure/image?size=medium&id=info:doi/10.1371/journal.pcbi.1005991.g006 "Click for larger image")

Fig 6. DCIS growth.

The deterministic and stochastic necrosis models both result in linear DCIS growth at approximately 1 cm/year (left), even while their cell counts differ by 21% by the end of the simulations (right).

[https://doi.org/10.1371/journal.pcbi.1005991.g006](https://doi.org/10.1371/journal.pcbi.1005991.g006)

#### Comparison with prior 2-D modeling results.

In 3D, neither necrosis model reproduced the mechanical “tears” between the proliferative rim and the necrotic core predicted by earlier 2-D simulations \[[14](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref014)\]; this is because more viable tissue is fluxing into smaller necrotic areas in the 3-D geometry compared to the 2-D geometry.

### Additional PhysiCell examples

In the following examples, we demonstrate PhysiCell in applications involving interactions via contact and chemical factors between multiple cell types, in 2-D and 3-D simulations. Most of the examples include cell motility, “custom” phenotype rules, additional “custom” mechanics, and custom data.

Please visit [http://www.mathcancer.org/blog/physicell-sample-projects/](http://www.mathcancer.org/blog/physicell-sample-projects/) for instructions on building, running, and visualizing the following sample projects. The sample projects are structured to mirror the intended design of user projects: a project-tailored Makefile and main.cpp in the main directory, and most custom code in the project-tailored functions in the custom\_modules directory.

The instructions can also be found in the User Guide ([S2 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s002), found in the documentation folder of every PhysiCell download) and the Quickstart guide ([S3 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s003), found in the root directory of every PhysiCell download).

#### “Biorobots”.

First, we tested PhysiCell for its potential in aiding in the design of synthetic multicellular systems. We investigated rulesets to create a cellular cargo delivery system, including the following main components:

1.  “Director” cells secrete a diffusible chemoattractant _c_1 and are otherwise static. They use the typical cell-cell repulsion mechanics.
2.  “Cargo” cells have a surface receptor 0 ≤ _R_ ≤ 1. When _R_ = 1, they secrete a diffusible chemoattractant _c_2. When _R_ = 0, they stop secreting the factor. They use the typical cell-cell repulsion mechanics.
3.  “Worker” cells can either be adhered or not adhered to cargo cells.
    1.  When they are unadhered, they perform biased random migration towards gradients of ∇_c_2. Whenever they touch a cell, they test for presence of receptor _R_. If _R_ is expressed (i.e., the worker has found cargo), the worker forms an elastic adhesion with the cell and sets _R_ = 0 on the cargo cell.
    2.  When they are adhered, they perform biased random migration towards ∇_c_1. When _c_1 exceeds a threshold, they break their adhesive bond.

As a simple model of this targeted cell adhesion, we used a custom\_cell\_rule to implement: ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e047)(21) ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e048)(22) for adhered cells _j_ and _i_. We then add these to the cell’s velocities. PhysiCell evaluates the custom rule when evaluating cell mechanics (velocity update).

Simulation outputs are shown in [Fig 7](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g007); see also [S5 Video](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s008). As we can see, the cargo and worker cells successfully interact to modulate their behaviors. Notably, the worker cells are seen making multiple transits from the supply of cellular cargo to the directors, showing the robustness of both the rules and their implementation in PhysiCell.

[![thumbnail](https://journals.plos.org/ploscompbiol/article/figure/image?size=inline&id=info:doi/10.1371/journal.pcbi.1005991.g007)](https://journals.plos.org/ploscompbiol/article/figure/image?size=medium&id=info:doi/10.1371/journal.pcbi.1005991.g007 "Click for larger image")

Fig 7. “Biorobots” example.

Director cells (green) release a chemoattractant _c_1 to guide worker cells (red). Cargo cells (blue) release a separate chemoattractant _c_2. Unadhered worker cells chemotax towards ∇_c_2, test for contact with cargo cells, form adhesive bonds, and then pull them towards the directors by following ∇_c_1. If _c_1 exceeds a threshold, the worker cells release the cargo and return to seek more cargo cells, repeating the cycle. Bar: 200 _μ_m. A video is available at [S5 Video](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s008).

[https://doi.org/10.1371/journal.pcbi.1005991.g007](https://doi.org/10.1371/journal.pcbi.1005991.g007)

This and the following examples also demonstrate the intended arrangement of projects: users do not modify the contents of ./core/, but instead place their codes in ./custom\_modules/, include these in a main project main.cpp, and modify the Makefile to compile and link the components. This design is intended to allow users to update the PhysiCell and BioFVM core components without overwriting their own customizations.

#### Anti-cancer biorobots.

We adapted the “biorobots” to test their potential as an anti-cancer treatment. Many proposed cancer therapies attempt to target cancer cells by finding unique surface or other molecules to target, so that drugs can be conjugated to custom antibodies or encapsulated in custom nanoparticles. These still generally rely upon passive delivery of the therapeutics, even though cancers are often poorly perfused. See e.g. \[[40](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref040), [41](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref041)\]. We tested the “biorobots” as a potential solution, with the following modifications:

1.  There are no “director” cells. Instead, cancer cells consume oxygen (as in prior examples), which creates an oxygen gradient that can be leveraged for worker cell “homing.”
2.  Adhered “cargo” cells detach themselves from “worker” cells when pO2 < pO2,drop and secrete a therapeutic compound \[drug\] that diffuses with the typical form given in **Biochemical microenvironment**.
3.  Adhered worker cells perform biased random migration along −∇pO2.
4.  In any time interval \[_t_, _t_ + Δ_t_cells\], cancer cells accumulate drug-induced damage according to: ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e049)(23) where _r_damage and _r_repair are the damage and repair rates. Each tumor cell agent tracks its own level of damage. In the same time interval the probability of a cell apoptosing due to the drug is ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e050)(24) where _r_death is the death rate when \[damage\] = 1.
5.  Unadhered worker cells disabled motility if _c_1 falls below a threshold value.

We simulated 1 week of tumor growth, “injected” a mixture of 10% worker cells and 90% cargo cells near the tumor, and set the parameter pO2,drop to 10 mmHg. In the simulation ([Fig 8](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g008) and [S6 Video](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s009)), overall the cargo cells were delivered into the tumor (and they can be seen pushing tumor cells out of the way), and tumor cells were indeed killed. However, once enough cancer cells were killed, hypoxia was reduced so that worker cells clustered near the oxygen minimum, but no longer released their “cargo” (because pO2 > pO2,drop throughout the domain). Setting pO2,drop = 15 mmHg reduced but did not eliminate this behavior. See [Fig 8](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g008) and [S6 Video](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s009). Thus, an “anti-cancer biorobot” system as explored here could potentially be beneficial (in particular, homing towards and penetrating tumors without need for cancer-specific targets), but the “cargo release” rules need to be carefully engineered. Such a system could potentially activate and deactivate to keep a tumor cell population in control, and to reduce hypoxia (which is known to drive cancer cell adaptation to more aggressive phenotypes \[[42](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref042), [43](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref043)\]).

[![thumbnail](https://journals.plos.org/ploscompbiol/article/figure/image?size=inline&id=info:doi/10.1371/journal.pcbi.1005991.g008)](https://journals.plos.org/ploscompbiol/article/figure/image?size=medium&id=info:doi/10.1371/journal.pcbi.1005991.g008 "Click for larger image")

Fig 8. Anti-cancer “biorobots” example.

By modifying the worker cells in the previous example ([Fig 7](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g007)) to move up hypoxic gradients (along −∇pO2) and drop their cargo in hypoxic zones, we can deliver cargo to a growing tumor. In this example, the cargo cells secrete a therapeutic that induces apoptosis in nearby tumor cells, leading to partial tumor regression. Bar: 200 _μ_m. A video is available at [S6 Video](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s009).

[https://doi.org/10.1371/journal.pcbi.1005991.g008](https://doi.org/10.1371/journal.pcbi.1005991.g008)

#### Cancer heterogeneity and immune response.

Next, we applied PhysiCell to another area of interest in the cancer community: heterogeneity. We seeded an initial tumor, and assigned each cell a random expression of a mutant “oncoprotein” 0 ≤ _p_ ≤ 2. We started the simulation with a normal distribution of _p_, with mean 1 and standard deviation of approximately 0.3. We used the same oxygen-dependent stochastic cell cycle entry and necrosis as in prior examples. We modified the model to set the rate of cycle entry to scale proportionally to _p_, so that increased _p_ increases the rate of cell division. The initial, intermediate, and final morphologies of the tumor are plotted in [Fig 9](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g009), along with the changing histograms of _p_. In the plot, cell color ranges from blue (_p_ = 0) to yellow (_p_ = 2). We can see clear selection for the yellower cells with greater expression of _p_. Moreover, see that while the initial tumor began with a uniform “salt and pepper” distribution of blue and yellow cells and a symmetric morphology, symmetry was broken by the end as regions with higher initial _p_ and greater access to oxygen form dominant focal growths of “yellow” clones. This demonstrates further stochasticity in the simulation that would be difficult to predict with continuum approaches. See [S7 Video](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s010) to better examine these dynamics.

[![thumbnail](https://journals.plos.org/ploscompbiol/article/figure/image?size=inline&id=info:doi/10.1371/journal.pcbi.1005991.g009)](https://journals.plos.org/ploscompbiol/article/figure/image?size=medium&id=info:doi/10.1371/journal.pcbi.1005991.g009 "Click for larger image")

Fig 9. Cancer heterogeneity example.

Each cell has an independent expression of a mutant “oncoprotein” _p_ (dimensionless, bounded in \[0, 2\]), which scales the oxygen-based rate of cell cycle entry. Blue cells have least _p_, and yellow cells have most. Initially, the population has normally distributed _p_ with mean 1, standard deviation 0.3, and a “salt and pepper” mixed spatial arrangement. The proliferative advantage for cells with higher _p_ leads to selection and enrichment of the most yellow cells. Stochastic effects lead to emergence of fast-growing foci and a loss of tumor symmetry. Bar: 200 _μ_m. A video is available at [S7 Video](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s010).

[https://doi.org/10.1371/journal.pcbi.1005991.g009](https://doi.org/10.1371/journal.pcbi.1005991.g009)

#### Adding an immune response.

We extended the heterogeneity example to 3D, and integrated a simple model of an immune attack on the heterogeneous tumor:

1.  All cancer cells consume oxygen as before. They also secrete an immunostimulatory factor _c_ (e.g., a chemokine such as basic fibroblast growth factor (bFGF) \[[44](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref044)\]), which diffuses according to the standard PDE we introduced earlier.
2.  As a simple model of immunogenicity, the mutant oncoprotein is assumed to increase immunogenicity proportionally to _p_, similarly to mutant tumor-associated epitopes being presented on MHCs (major histocompatibility complexes) \[[45](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref045), [46](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref046)\].
3.  Unadhered immune cells perform biased random migration (in our simulations _b_ = 0.5) towards ∇_c_ and test for contact with cells. If they detect contact, they form an adhesion using the same model as in the **“Biorobots”** example and switch off motility. In any time interval \[_t_, _t_ + Δ_t_\], we give the cell a probability of forming an adhesion regulated by ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e051)(25) where _r_adhesion is the immune cell’s rate of forming new cell adhesions.
4.  While adhered, immune cells attempt to induce apoptosis in the adhered cell with probability ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e052)(26) where _p_ is used as our surrogate marker for immunogenicity (see above), and _r_kill is the rate at which adhered immune cells kill tumor cells with _p_ = 1. If they induce apoptosis, they detach and resume their search for new cells.
5.  Adhered immune cells have a probability of detachment given by ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e053)(27)

In [Fig 10](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g010) and [S8 Video](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s011), we first simulate two weeks of tumor growth without an immune reaction. As in the prior example, we see the initially symmetric tumor develop asymmetric focal growths of “yellow” cells, again showing the selection for cells with the most oncoprotein. At two weeks, we introduce 7500 immune cells (red) that invade the tumor. Apoptotic tumor cells are labeled in cyan. The immune cells continue to migrate towards the center of the tumor up gradients of _c_, and within a few days, the tumor cell population is drastically reduced, with more “blue” cells (less immunogenic) remaining than “yellow cells” (most immunogenic). However, because immune cell migration was strongly biased along ∇_c_, they pass by some tumor cells at the outer periphery. These surviving cells repopulate the tumor. This highlights the importance of stochasticity in immune cell migration; if homing is too strong, immune cells cannot mix with tumor cells, leading them to cluster in dense regions which can only interact with tumor cells on their edges. Less biased migration would increase mixing of cancer and immune cells and increase the efficacy of the immune attack.

[![thumbnail](https://journals.plos.org/ploscompbiol/article/figure/image?size=inline&id=info:doi/10.1371/journal.pcbi.1005991.g010)](https://journals.plos.org/ploscompbiol/article/figure/image?size=medium&id=info:doi/10.1371/journal.pcbi.1005991.g010 "Click for larger image")

Fig 10. Cancer immunology example.

In this 3-D example, each tumor cell secretes an immunostimulatory factor, and its immunogenicity is modeled as proportional to its mutant oncoprotein expression. (See the previous example in [Fig 9](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g009).) After 14 days, red immune cells perform a biased random walk towards the immunostimulatory factor, test for contact with cells, form adhesions, and attempt to induce apoptosis for cells with greater immunogenicity. The immune cells successfully attack the tumor initially, leading to partial regression; apoptotic cells are cyan. But strong homing towards gradients of the immunostimulatory factor causes immune cells to “pass” some cells at the outer edge, leading to tumor regrowth. Eventually, immune cells leave the necrotic regions and press their attack on the tumor. This highlights the importance of stochasticity in immune cell movement in mixing with the tumor cells for a more successful immune response. A video is available at [S8 Video](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s011).

[https://doi.org/10.1371/journal.pcbi.1005991.g010](https://doi.org/10.1371/journal.pcbi.1005991.g010)

In \[[20](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref020), [21](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref021)\], we used high-throughput computing to further expand this investigation to explore the impact of stochastic migration and tumor-immune cell adhesion dynamics on the treatment efficacy.

## Availability and future directions

### Getting started as a new PhysiCell user/developer

#### Learning to use PhysiCell.

PhysiCell’s main project website can be found at [http://PhysiCell.MathCancer.org](http://physicell.mathcancer.org/).

Each PhysiCell download comes with a Quickstart guide (Quickstart.pdf) in the main directory (see [S3 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s003)). We recommend running through this guide to populate, compile, run, and visualize your first projects. (The four examples in **Additional PhysiCell examples** are included as sample projects, with compile instructions in the Quickstart; see [S3 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s003).)

A full User Guide (see [S2 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s002)) is included in the documentation directory of every PhysiCell download. See documentation/User\_Guide.pdf. The User Guide includes full details on how to access and modify each cell’s Phenotype, how to write custom functions and data elements, and how to interact with the BioFVM microenvironment \[[6](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref006)\].

Users creating their own simulation projects should start with the 2-D and 3-D template projects. User-created code should be placed in the custom\_modules directory; users should not modify functions in core (core PhysiCell functionality) or modules (PhysiCell-provided, non-core functions). See the Quickstart ([S3 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s003)) and User Guide ([S2 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s002)) for further details.

We post tutorials at our PhysiCell blog, available at [http://mathcancer.org/blog/physicell-tutorials](http://mathcancer.org/blog/physicell-tutorials).

Check there for tips and tricks to building simulators, and visualizing results. We also frequently post updates on PhysiCell on Twitter, under the hashtag #PhysiCell.

### Getting started as a new PhysiCell contributor

We welcome new functionality and bug fix contributions from the community. No special tools or libraries are required for PhysiCell development aside from a C++11/OpenMP compliant compiler, make, and a copy of the PhysiCell source. Developers should fork the current development version of the PhysiCell repository (available on GitHub at [https://github.com/MathCancer/PhysiCell](https://github.com/MathCancer/PhysiCell)), develop their contributions (either in the modules directory as new functions, named as PhysiCell\_\[name\].cpp, or as fixes to existing files), and then submit a pull request. Users should also email the PhysiCell mailing list when submitting code contributions.

Project coding conventions can be found at [http://www.mathcancer.org/blog/mathcancer-c-style-and-practices-guide/](http://www.mathcancer.org/blog/mathcancer-c-style-and-practices-guide/).

### Limitations and potential solutions

#### Scientific limitations.

BioFVM does not implement advective transport as of Version 1.1.7, and so PhysiCell cannot readily be applied to advection-dominated problems without user-supplied advection solvers. We also have not yet written a model of extracellular matrix; users could add this effect by introducing custom data that (1) “anchors” each cell to a position in space beyond cell-cell mechanical operations, and (2) slowly evolve these “anchor points” to model ECM rearrangement. We are currently exploring this approach to model liver parenchyma, and we will post sample codes as the work progresses. Alternatively, users could introduce an independent finite element mesh for the ECM, evolve it under (e.g., viscoelastic) laws, and attach cells to the nearest lattice site. As a simpler approach, users could include a non-diffusing ECM substrate (in BioFVM), which could be used to reduce the cells’ velocities (as extra drag). Vary the cell-cell mechanics parameters in phenotype.mechanics with the ECM density for this approach.

PhysiCell’s cell-centered approach may not be ideal for application to some morphogenesis problems; see the recent work by Osborne and co-workers that compared several discrete modeling frameworks in morphogenesis test problems \[[47](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref047)\]. PhysiCell does not model cell morphology, and so it cannot directly model cell elongation processes needed in some morphogenesis problems. However, users could potentially model elongated cells as two or more agents, and introduce manual adhesive links similar to our “biorobots” examples. PhysiCell has not implemented cell fusion (another mechanism of morphogenesis), but users could manually implement this by (1) testing for cell-cell contact, (2) moving one cell to the center of volume of the two cells, (3) updating that cell’s volume to include both original cells’ volumes, and (4) deleting the second cell. PhysiCell has not yet written functions to deal with polarized cell-cell adhesion, or to update its orientation. Thus, PhysiCell may need further development and user contributions to model the full spectrum of morphogenetic mechanisms.

We note that PhysiCell can manually implement molecular-scale biology as ODEs (e.g., as in the drug damage example) via custom functions and data, but this is currently difficult to scale to large systems of ODEs with many parameters. Moreover, while we have provided examples of user-defined cell cycle models and other custom functions in the User Guide, sample codes, and tutorials, we do not provide templates for such functions beyond the documentation. We are currently testing methods to support SBML specification of ODE models in the cell agents (e.g., via libRoadrunner \[[48](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref048)\]), but until SBML is supported, we do not provide templates to integrate ODE models into PhysiCell functions to alter cell phenotype.

PhysiCell does not currently provide direct methods to model contact-based cell-cell interactions; these can be manually implemented as we did in the immune and biorobots examples. We also do not yet provide alternative mechanics models (e.g., viscoelastic) out-of-the-box, but users can design their own cell velocity functions as needed to replace the default mechanics. We have not yet implemented direct calculations of cell pressures and strains, so this could hinder some applications in mechanobiology. Users could implement this by creating a custom velocity update function that calculates pressures and strains from the potential functions. A preliminary version—calculated from the “resistance” potential functions similarly to \[[49](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref049)\]—is included as state.basic\_pressure. See the User Guide ([S2 Text](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.s002)) for more details.

#### Software limitations.

PhysiCell is intended to function as a modular engine and to interact with standardized data (e.g., MultiCellDS \[[22](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref022)\]), but it has not yet fully implemented MultiCellDS import and export. Graphical simulation design tools, data visualization tools, and analysis tools are needed to widen its accessibility beyond seasoned C++ programmers and reduce its learning curve. In the future, PhysiCell should switch from Makefiles to CMake to facilitate simpler cross-platform compiling.

### Future improvements

#### Numerical improvements.

The biggest performance bottleneck is cell-cell interaction testing: cell volume can vary by a factor of 100, and hence the cell diameter (and interaction distance) can vary by a factor of 50. The number of cells in the list of interacting neighbors ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e054) scales inversely with the minimum cell volume; see **Expanded computational cost estimates**. Future versions of PhysiCell will introduce a nested mesh interaction testing structure to more accurately estimate ![](https://journals.plos.org/ploscompbiol/article/file?type=thumbnail&id=info:doi/10.1371/journal.pcbi.1005991.e055) in regions with small cells. Although PhysiCell’s design objectives are not focused on larger simulations with 108\-109 cells, extension to supercomputers by wrapping the code in MPI with appropriate data mirroring could be useful. Likewise, the algorithms used in BioFVM could be implemented on a graphics card via OpenCL or OpenACC. We will explore these approaches in the future.

#### Scientific improvements.

We will develop SBML (systems biology markup language) importers for molecular-scale biology, most likely by the C code generation features in COPASI \[[50](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref050)\] or libRoadrunner \[[48](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref048)\]. This will make it straightforward to integrate systems of ODEs to individual cells. We will add new cycle models for flow cytometry-driven problems (G1, S, and G2/M phases). We plan to add more advanced cell mechanics models (e.g., as in \[[9](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref009), [51](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref051), [52](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref052)\]), and to extend PhysiCell’s included standard functions to include extracellular matrix mechanics. We also plan to introduce built-in functions for polarized cell adhesion and updating the cells’ orientations. As our PhysiCell-based projects progress, we will “upstream” our new functions to PhysiCell as new optional modules. We are currently testing and refining the elastic-based cell adhesions in **Additional PhysiCell examples** for inclusion as standard models, and we are also developing vascularization libraries as part of our work to simulate metastatic breast cancers injected in mammary fat pads.

#### User-focused improvements.

In the coming months, we will continue publishing blog posts and code samples at [http://MathCancer.org/blog/physicell-tutorials/](http://mathcancer.org/blog/physicell-tutorials/). We will create pre-compiled clients that can initiate simulations based upon a digital snapshot (initial arrangement of cells) and digital cell lines (self-contained, model-independent sets of cell phenotype data), using the emerging MultiCellDS standard \[[22](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref022), [23](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref023)\]. We will develop support to read parameters from XML configuration files, and we plan to offer PhysiCell as a compiled, linkable library. Moreover, we plan to develop user-friendly, web-based applications of PhysiCell to simulate the multicellular response to diffusing engineered nanoparticles \[[53](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi.1005991.ref053)\].

## Supporting information

### [S1 Text.](https://journals.plos.org/ploscompbiol/article/file?type=supplementary&id=info:doi/10.1371/journal.pcbi.1005991.s001) Supplemental information.

Extensive supplemental information including: full mathematical model details, supporting literature, and reference parameter values for breast epithelial cells; expanded numerical implementation details; convergence and validation testing results; full parameter values for the main tests; and an expanded feature comparison of PhysiCell and other 3-D multicellular simulation platforms.

[https://doi.org/10.1371/journal.pcbi.1005991.s001](https://doi.org/10.1371/journal.pcbi.1005991.s001)

(PDF)

## Acknowledgments

We thank Margy Villa for her assistance in early testing, and Edwin Juarez and Rishi Rawat for useful discussions. We greatly appreciate the deep discussions with the MultiCellDS review panel in developing standardized cell cycle and death models. We thank Jakob Kather and Jan Poleszczuk for discussions on cancer immunology. We thank Nathan Choi for his 3-D hanging drop spheroid work in [Fig 2](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991#pcbi-1005991-g002).

## References

1.  1\. Macklin P. Biological background. In: Cristini V. and Lowengrub J.S., Multiscale Modeling of Cancer: An Integrated Experimental and Mathematical Modeling Approach. Cambridge, UK: Cambridge University Press; 2010. p. 8–23. (invited author: P. Macklin). Available from: [http://dx.doi.org/10.1017/CBO9780511781452.003](http://dx.doi.org/10.1017/CBO9780511781452.003).
    
2.  2\. Lowengrub J, Frieboes HB, Jin F, Chuang YL, Li X, Macklin P, et al. Nonlinear modeling of cancer: Bridging the gap between cells and tumors. Nonlinearity. 2010;23(1):R1–R91. (invited author: J. Lowengrub). Available from: [http://dx.doi.org/10.1088/0951-7715/23/1/R01](http://dx.doi.org/10.1088/0951-7715/23/1/R01). pmid:20808719
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/20808719 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Nonlinear+modeling+of+cancer%3A+Bridging+the+gap+between+cells+and+tumors+Lowengrub+2010 "Go to article in Google Scholar")
3.  3\. Deisboeck TS, Wang Z, Macklin P, Cristini V. Multiscale Cancer Modeling. Annu Rev Biomed Eng. 2011;13:127–155. (invited author: T.S. Deisboeck). Available from: [http://dx.doi.org/10.1146/ANNUREV-BIOENG-071910-124729](http://dx.doi.org/10.1146/ANNUREV-BIOENG-071910-124729). pmid:21529163
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/21529163 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Multiscale+Cancer+Modeling+Deisboeck+2011 "Go to article in Google Scholar")
4.  4\. Hatzikirou H, Chauviere A, Bauer AL, Leier A, Lewis MT, Macklin P, et al. Integrative physical oncology. WIREs Syst Biol Med. 2012;4(1):1–14. (invited author: V. Cristini). Available from: [http://dx.doi.org/10.1002/wsbm.158](http://dx.doi.org/10.1002/wsbm.158).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Integrative+physical+oncology+Hatzikirou+2012 "Go to article in Google Scholar")
5.  5\. Macklin P, Frieboes HB, Sparks JL, Ghaffarizadeh A, Friedman SH, Juarez EF, et al. In: Rejniak KA, editor. Progress Towards Computational 3-D Multicellular Systems Biology. vol. 936. Bern, Switzerland: Springer; 2016. p. 225–246. (invited author: P. Macklin). Available from: [http://dx.doi.org/10.1007/978-3-319-42023-3\_12](http://dx.doi.org/10.1007/978-3-319-42023-3_12).
    
6.  6\. Ghaffarizadeh A, Friedman SH, Macklin P. BioFVM: an efficient, parallelized diffusive transport solver for 3-D biological simulations. Bioinformatics. 2016;32(8):1256–1258. Available from: [http://dx.doi.org/10.1093/bioinformatics/btv730](http://dx.doi.org/10.1093/bioinformatics/btv730). pmid:26656933
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/26656933 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=BioFVM%3A+an+efficient%2C+parallelized+diffusive+transport+solver+for+3-D+biological+simulations+Ghaffarizadeh+2016 "Go to article in Google Scholar")
7.  7\. Swat MH, Thomas GL, Belmonte JM, Shirinifard A, Hmeljak D, Glazier JA. Chapter 13—Multi-Scale Modeling of Tissues Using CompuCell3D. In: Asthagiri AR, Arkin AP, editors. Computational Methods in Cell Biology. vol. 110 of Methods in Cell Biology. Academic Press; 2012. p. 325–366. Available from: [http://dx.doi.org/10.1016/B978-0-12-388403-9.00013-8](http://dx.doi.org/10.1016/B978-0-12-388403-9.00013-8).
    
8.  8\. Starruß J, de Back W, Brusch L, Deutsch A. Morpheus: a user-friendly modeling environment for multiscale and multicellular systems biology. Bioinformatics. 2014;30(9):1331–1332. Available from: [http://dx.doi.org/10.1093/bioinformatics/btt772](http://dx.doi.org/10.1093/bioinformatics/btt772). pmid:24443380
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/24443380 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Morpheus%3A+a+user-friendly+modeling+environment+for+multiscale+and+multicellular+systems+biology+Starru%C3%9F+2014 "Go to article in Google Scholar")
9.  9\. Hoehme S, Drasdo D. A cell-based simulation software for multi-cellular systems. Bioinformatics. 2010;26(20):2641–2642. Available from: [http://dx.doi.org/10.1093/bioinformatics/btq437](http://dx.doi.org/10.1093/bioinformatics/btq437). pmid:20709692
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/20709692 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=A+cell-based+simulation+software+for+multi-cellular+systems+Hoehme+2010 "Go to article in Google Scholar")
10.  10\. Mirams GR, Arthurs CJ, Bernabeu MO, Bordas R, Cooper J, Corrias A, et al. Chaste: An Open Source C++ Library for Computational Physiology and Biology. PLoS Comput Biol. 2013 03;9(3):1–8. Available from: [http://dx.doi.org/10.1371/journal.pcbi.1002970](http://dx.doi.org/10.1371/journal.pcbi.1002970).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Chaste%3A+An+Open+Source+C%2B%2B+Library+for+Computational+Physiology+and+Biology+Mirams+2013 "Go to article in Google Scholar")
11.  11\. Kang S, Kahan S, McDermott J, Flann N, Shmulevich I. Biocellion: accelerating computer simulation of multicellular biological system models. Bioinformatics. 2014;30(21):3101–3108. Available from: [http://dx.doi.org/10.1093/bioinformatics/btu498](http://dx.doi.org/10.1093/bioinformatics/btu498). pmid:25064572
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/25064572 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Biocellion%3A+accelerating+computer+simulation+of+multicellular+biological+system+models+Kang+2014 "Go to article in Google Scholar")
12.  12\. Cytowski M, Szymanska Z. Large-Scale Parallel Simulations of 3D Cell Colony Dynamics. Computing in Science Engineering. 2014 Sept;16(5):86–95. Available from: [http://dx.doi.org/10.1109/MCSE.2014.2](http://dx.doi.org/10.1109/MCSE.2014.2).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Large-Scale+Parallel+Simulations+of+3D+Cell+Colony+Dynamics+Cytowski+2014 "Go to article in Google Scholar")
13.  13\. Cytowski M, Szymanska Z. Large-Scale Parallel Simulations of 3D Cell Colony Dynamics: The Cellular Environment. Computing in Science Engineering. 2015 Sept;17(5):44–48. Available from: [http://dx.doi.org/10.1109/MCSE.2015.66](http://dx.doi.org/10.1109/MCSE.2015.66).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Large-Scale+Parallel+Simulations+of+3D+Cell+Colony+Dynamics%3A+The+Cellular+Environment+Cytowski+2015 "Go to article in Google Scholar")
14.  14\. Macklin P, Edgerton ME, Thompson AM, Cristini V. Patient-calibrated agent-based modelling of ductal carcinoma in situ (DCIS): From microscopic measurements to macroscopic predictions of clinical progression. J Theor Biol. 2012;301:122–40. Available from: [http://dx.doi.org/10.1016/j.jtbi.2012.02.002](http://dx.doi.org/10.1016/j.jtbi.2012.02.002). pmid:22342935
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/22342935 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Patient-calibrated+agent-based+modelling+of+ductal+carcinoma+in+situ+%28DCIS%29%3A+From+microscopic+measurements+to+macroscopic+predictions+of+clinical+progression+Macklin+2012 "Go to article in Google Scholar")
15.  15\. Hyun AZ, Macklin P. Improved patient-specific calibration for agent-based cancer modeling. J Theor Biol. 2013;317:422–4. Available from: [http://dx.doi.org/10.1016/j.jtbi.2012.10.017](http://dx.doi.org/10.1016/j.jtbi.2012.10.017). pmid:23084996
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/23084996 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Improved+patient-specific+calibration+for+agent-based+cancer+modeling+Hyun+2013 "Go to article in Google Scholar")
16.  16\. Mumenthaler SM, D’Antonio G, Preziosi L, Macklin P. The need for integrative computational oncology: An illustrated example through MMP-mediated tissue degradation. Front Oncol. 2013;3:194. Available from: [http://dx.doi.org/10.3389/fonc.2013.00194](http://dx.doi.org/10.3389/fonc.2013.00194). pmid:23898463
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/23898463 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=The+need+for+integrative+computational+oncology%3A+An+illustrated+example+through+MMP-mediated+tissue+degradation+Mumenthaler+2013 "Go to article in Google Scholar")
17.  17\. Grogan JA, Connor AJ, Markelc B, Muschel RJ, Maini PK, Byrne HM, et al. Microvessel Chaste: An Open Library for Spatial Modeling of Vascularized Tissues. Biophys J. 2017;112(9):1767–72. Available from: [http://dx.doi.org/10.1016/j.bpj.2017.03.036](http://dx.doi.org/10.1016/j.bpj.2017.03.036). pmid:28494948
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/28494948 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Microvessel+Chaste%3A+An+Open+Library+for+Spatial+Modeling+of+Vascularized+Tissues+Grogan+2017 "Go to article in Google Scholar")
18.  18\. Schumacher LJ, Maini PK, Baker RE. Semblance of Heterogeneity in Collective Cell Migration. Cell Sys. 2017;5(2):119–27. Available from: [https://dx.doi.org/10.1016/j.cels.2017.06.006](https://dx.doi.org/10.1016/j.cels.2017.06.006).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Semblance+of+Heterogeneity+in+Collective+Cell+Migration+Schumacher+2017 "Go to article in Google Scholar")
19.  19\. Macklin P. When Seeing Isn’t Believing: How Math Can Guide Our Interpretation of Measurements and Experiments. Cell Sys. 2017;5(2):92–4. Available from: [http://dx.doi.org/10.1016/j.cels.2017.08.005](http://dx.doi.org/10.1016/j.cels.2017.08.005).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=When+Seeing+Isn%E2%80%99t+Believing%3A+How+Math+Can+Guide+Our+Interpretation+of+Measurements+and+Experiments+Macklin+2017 "Go to article in Google Scholar")
20.  20\. Ozik J, Collier N, Wozniak J, Macal C, Cockrell C, Friedman S, et al. High-throughput cancer hypothesis testing with an integrated PhysiCell-EMEWS workflow. bioRxiv, accepted SuperComputing SC17 Computational Approaches for Cancer Workshop. 2017;p. 196709. Available from: [https://dx.doi.org/10.1101/196709](https://dx.doi.org/10.1101/196709).
    
21.  21\. Ozik J, Collier N, Wozniak J, Macal C, Cockrell C, Friedman S, et al. High-throughput cancer hypothesis testing with an integrated PhysiCell-EMEWS workflow \[Presented at SuperComputing SC17, Computational Approaches for Cancer Workshop\]. FigShare. 2017;p. 5687197.v1. Available from: [https://dx.doi.org/10.6084/m9.figshare.5687197.v1](https://dx.doi.org/10.6084/m9.figshare.5687197.v1).
    
22.  22\. Friedman SH, Anderson ARA, Bortz DM, Fletcher AG, Frieboes HB, Ghaffarizadeh A, et al. MultiCellDS: a community-developed standard for curating microenvironment-dependent multicellular data. bioRxiv. 2016;Available from: [https://dx.doi.org/10.1101/090456](https://dx.doi.org/10.1101/090456).
    
23.  23\. Macklin P, et al.. MultiCellDS Project Website; 2014-2016. Available from: [http://MultiCellDS.org](http://multicellds.org/).
    
24.  24\. Benson J, Macklin P. 43. Cell-based modeling of mechanical and chemical stress in tissues during cryoprotocols. Cryobiology. 2015;71(1):176. Available from: [http://dx.doi.org/10.1016/j.cryobiol.2015.05.049](http://dx.doi.org/10.1016/j.cryobiol.2015.05.049).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=43.+Cell-based+modeling+of+mechanical+and+chemical+stress+in+tissues+during+cryoprotocols+Benson+2015 "Go to article in Google Scholar")
25.  25\. Kapoulkine A. pugixml: Light-weight, simple and fast XML parser for C++ with XPath support; 2015. Available from: [https://github.com/zeux/pugixml](https://github.com/zeux/pugixml).
    
26.  26\. Simpson MJ, Towne C, McElwain DLS, Upton Z. Migration of breast cancer cells: Understanding the roles of volume exclusion and cell-to-cell adhesion. Phys Rev E. 2010 Oct;82:041901. Available from: [https://dx.doi.org/10.1103/PhysRevE.82.041901](https://dx.doi.org/10.1103/PhysRevE.82.041901).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Migration+of+breast+cancer+cells%3A+Understanding+the+roles+of+volume+exclusion+and+cell-to-cell+adhesion+Simpson+2010 "Go to article in Google Scholar")
27.  27\. Drasdo D, Kree R, McCaskill JS. Monte Carlo approach to tissue-cell populations. Phys Rev E. 1995 Dec;52:6635–6657. Available from: [http://dx.doi.org/10.1103/PhysRevE.52.6635](http://dx.doi.org/10.1103/PhysRevE.52.6635).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Monte+Carlo+approach+to+tissue-cell+populations+Drasdo+1995 "Go to article in Google Scholar")
28.  28\. Galle J, Loeffler M, Drasdo D. Modeling the Effect of Deregulated Proliferation and Apoptosis on the Growth Dynamics of Epithelial Cell Populations In Vitro. Biophys J. 2005;88(1):62–75. Available from: [http://dx.doi.org/10.1529/biophysj.104.041459](http://dx.doi.org/10.1529/biophysj.104.041459). pmid:15475585
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/15475585 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Modeling+the+Effect+of+Deregulated+Proliferation+and+Apoptosis+on+the+Growth+Dynamics+of+Epithelial+Cell+Populations+In+Vitro+Galle+2005 "Go to article in Google Scholar")
29.  29\. Macklin P, Lowengrub JS. Evolving interfaces via gradients of geometry-dependent interior Poisson problems: application to tumor growth. J Comput Phys. 2005;203(1):191–220. Available from: [http://dx.doi.org/10.1016/j.jcp.2004.08.010](http://dx.doi.org/10.1016/j.jcp.2004.08.010).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Evolving+interfaces+via+gradients+of+geometry-dependent+interior+Poisson+problems%3A+application+to+tumor+growth+Macklin+2005 "Go to article in Google Scholar")
30.  30\. Macklin P, Lowengrub JS. Nonlinear simulation of the effect of microenvironment on tumor growth. J Theor Biol. 2007;245(4):677–704. Available from: [http://dx.doi.org/10.1016/j.jtbi.2006.12.004](http://dx.doi.org/10.1016/j.jtbi.2006.12.004). pmid:17239903
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/17239903 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Nonlinear+simulation+of+the+effect+of+microenvironment+on+tumor+growth+Macklin+2007 "Go to article in Google Scholar")
31.  31\. Macklin P, Lowengrub JS. A New Ghost Cell/Level Set Method for Moving Boundary Problems: Application to Tumor Growth. J Sci Comput. 2008;35(2-3):266–299. (invited author: J.S. Lowengrub). Available from: [http://dx.doi.org/10.1007/s10915-008-9190-z](http://dx.doi.org/10.1007/s10915-008-9190-z). pmid:21331304
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/21331304 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=A+New+Ghost+Cell%2FLevel+Set+Method+for+Moving+Boundary+Problems%3A+Application+to+Tumor+Growth+Macklin+2008 "Go to article in Google Scholar")
32.  32\. Edgerton ME, Chuang YL, Macklin P, Yang W, Bearer EL, Cristini V. A novel, patient-specific mathematical pathology approach for assessment of surgical volume: Application to ductal carcinoma in situ of the breast. Anal Cell Pathol. 2011;34(5):247–63. Available from: [http://dx.doi.org/10.3233/ACP-2011-0019](http://dx.doi.org/10.3233/ACP-2011-0019).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=A+novel%2C+patient-specific+mathematical+pathology+approach+for+assessment+of+surgical+volume%3A+Application+to+ductal+carcinoma+in+situ+of+the+breast+Edgerton+2011 "Go to article in Google Scholar")
33.  33\. Macklin P, Mumenthaler S, Lowengrub J. Modeling multiscale necrotic and calcified tissue biomechanics in cancer patients: application to ductal carcinoma in situ (DCIS). In: Gefen A, editor. Multiscale Computer Modeling in Biomechanics and Biomedical Engineering. Berlin, Germany: Springer; 2013. p. 349–80. (invited author: P. Macklin). Available from: [http://dx.doi.org/10.1007/8415\_2012\_150](http://dx.doi.org/10.1007/8415_2012_150).
    
34.  34\. Majno G, Joris I. Apoptosis, oncosis, and necrosis. An overview of cell death. The American journal of pathology. 1995;146(1):3. Available from: [https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1870771/](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1870771/). pmid:7856735
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/7856735 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Apoptosis%2C+oncosis%2C+and+necrosis.+An+overview+of+cell+death+Majno+1995 "Go to article in Google Scholar")
35.  35\. Trump BE, Berezesky IK, Chang SH, Phelps PC. The Pathways of Cell Death: Oncosis, Apoptosis, and Necrosis. Toxicologic Pathology. 1997;25(1):82–88. Available from: [https://dx.doi.org/10.1177/019262339702500116](https://dx.doi.org/10.1177/019262339702500116). pmid:9061857
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/9061857 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=The+Pathways+of+Cell+Death%3A+Oncosis%2C+Apoptosis%2C+and+Necrosis+Trump+1997 "Go to article in Google Scholar")
36.  36\. Garvey CM, Spiller E, Lindsay D, Chiang CT, Choi NC, Agus DB, et al. A high-content image-based method for quantitatively studying context-dependent cell population dynamics. Sci Rep. 2016;6:29752. Available from: [http://dx.doi.org/10.1038/srep29752](http://dx.doi.org/10.1038/srep29752). pmid:27452732
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/27452732 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=A+high-content+image-based+method+for+quantitatively+studying+context-dependent+cell+population+dynamics+Garvey+2016 "Go to article in Google Scholar")
37.  37\. McKeown SR. Defining normoxia, physoxia and hypoxia in tumours—implications for treatment response. The British Journal of Radiology. 2014;87(1035):20130676. Available from: [http://dx.doi.org/10.1259/bjr.20130676](http://dx.doi.org/10.1259/bjr.20130676). pmid:24588669
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/24588669 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Defining+normoxia%2C+physoxia+and+hypoxia+in+tumours%E2%80%94implications+for+treatment+response+McKeown+2014 "Go to article in Google Scholar")
38.  38\. Ghosh S, Joshi MB, Ivanov D, Feder-Mengus C, Spagnoli GC, Martin I, et al. Use of multicellular tumor spheroids to dissect endothelial cell–tumor cell interactions: A role for T-cadherin in tumor angiogenesis. FEBS Letters. 2007;581(23):4523–4528. Available from: [http://dx.doi.org/10.1016/j.febslet.2007.08.038](http://dx.doi.org/10.1016/j.febslet.2007.08.038). pmid:17765896
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/17765896 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Use+of+multicellular+tumor+spheroids+to+dissect+endothelial+cell%E2%80%93tumor+cell+interactions%3A+A+role+for+T-cadherin+in+tumor+angiogenesis+Ghosh+2007 "Go to article in Google Scholar")
39.  39\. Ma Hl, Jiang Q, Han S, Wu Y, Tomshine JC, Wang D, et al. Multicellular Tumor Spheroids as an in Vivo–Like Tumor Model for Three-Dimensional Imaging of Chemotherapeutic and Nano Material Cellular Penetration. Molecular Imaging. 2012;11(6). Available from: [http://journals.sagepub.com/doi/abs/10.2310/7290.2012.00012](http://journals.sagepub.com/doi/abs/10.2310/7290.2012.00012). pmid:23084249
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/23084249 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Multicellular+Tumor+Spheroids+as+an+in+Vivo%E2%80%93Like+Tumor+Model+for+Three-Dimensional+Imaging+of+Chemotherapeutic+and+Nano+Material+Cellular+Penetration+Ma+2012 "Go to article in Google Scholar")
40.  40\. Kwon IK, Lee SC, Han B, Park K. Analysis on the current status of targeted drug delivery to tumors. Journal of Controlled Release. 2012;164(2):108–114. Drug Delivery and Cancer: Today’s Challenges, Tomorrow’s Directions. Available from: [https://dx.doi.org/10.1016/j.jconrel.2012.07.010](https://dx.doi.org/10.1016/j.jconrel.2012.07.010). pmid:22800574
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/22800574 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Analysis+on+the+current+status+of+targeted+drug+delivery+to+tumors+Kwon+2012 "Go to article in Google Scholar")
41.  41\. Cukierman E, Khan DR. The benefits and challenges associated with the use of drug delivery systems in cancer therapy. Biochemical Pharmacology. 2010;80(5):762–770. Targeted Cancer Therapy. Available from: [http://dx.doi.org/10.1016/j.bcp.2010.04.020](http://dx.doi.org/10.1016/j.bcp.2010.04.020). pmid:20417189
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/20417189 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=The+benefits+and+challenges+associated+with+the+use+of+drug+delivery+systems+in+cancer+therapy+Cukierman+2010 "Go to article in Google Scholar")
42.  42\. Eales KL, Hollinshead KER, Tennant DA. Hypoxia and metabolic adaptation of cancer cells. Oncogenesis. 2016;5:e190. Available from: [https://dx.doi.org/10.1038/oncsis.2015.50](https://dx.doi.org/10.1038/oncsis.2015.50). pmid:26807645
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/26807645 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Hypoxia+and+metabolic+adaptation+of+cancer+cells+Eales+2016 "Go to article in Google Scholar")
43.  43\. Wilson WR, Hay MP. Targeting hypoxia in cancer therapy. Nat Rev Canc. 2011;11(6):393–410. Available from: [http://dx.doi.org/10.1038/nrc3064](http://dx.doi.org/10.1038/nrc3064).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Targeting+hypoxia+in+cancer+therapy+Wilson+2011 "Go to article in Google Scholar")
44.  44\. Ichim CV. Revisiting immunosurveillance and immunostimulation: Implications for cancer immunotherapy. Journal of Translational Medicine. 2005 Feb;3(1):8. Available from: [https://doi.org/10.1186/1479-5876-3-8](https://doi.org/10.1186/1479-5876-3-8). pmid:15698481
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/15698481 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Revisiting+immunosurveillance+and+immunostimulation%3A+Implications+for+cancer+immunotherapy+Ichim+2005 "Go to article in Google Scholar")
45.  45\. Khanna R. Tumour surveillance: Missing peptides and MHC molecules. Immunol Cell Biol. 1998;76(1):20–6. Available from: [http://dx.doi.org/10.1046/j.1440-1711.1998.00717.x](http://dx.doi.org/10.1046/j.1440-1711.1998.00717.x). pmid:9553772
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/9553772 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Tumour+surveillance%3A+Missing+peptides+and+MHC+molecules+Khanna+1998 "Go to article in Google Scholar")
46.  46\. Comber JD, Philip R. MHC class I antigen presentation and implications for developing a new generation of therapeutic vaccines. Therapeutic Advances in Vaccines. 2014;2(3):77–89. Available from: [http://dx.doi.org/10.1177/2051013614525375](http://dx.doi.org/10.1177/2051013614525375). pmid:24790732
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/24790732 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=MHC+class+I+antigen+presentation+and+implications+for+developing+a+new+generation+of+therapeutic+vaccines+Comber+2014 "Go to article in Google Scholar")
47.  47\. Osborne JM, Flecther AG, Pitt-Francis JM, Maini PK, Gavaghan DJ. Comparing individual-based approaches to modelling the self-organization of multicellular tissues. PLoS Comput Biol. 2017;13(2):e1005387. Available from: [http://dx.doi.org/10.1371/journal.pcbi.1005387](http://dx.doi.org/10.1371/journal.pcbi.1005387). pmid:28192427
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/28192427 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Comparing+individual-based+approaches+to+modelling+the+self-organization+of+multicellular+tissues+Osborne+2017 "Go to article in Google Scholar")
48.  48\. Somogyi ET, Bouteiller JM, Glazier JA, König M, Medley JK, Swat MH, et al. libRoadRunner: a high performance SBML simulation and analysis library. Bioinformatics. 2015;31(20):3315–21. Available from: [http://dx.doi.org/10.1093/bioinformatics/btv363](http://dx.doi.org/10.1093/bioinformatics/btv363). pmid:26085503
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/26085503 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=libRoadRunner%3A+a+high+performance+SBML+simulation+and+analysis+library+Somogyi+2015 "Go to article in Google Scholar")
49.  49\. Byrne H, Drasdo D. Individual-based and continuum models of growing cell populations: a comparison. J Math Biol. 2009;58(4–5):657–87. Available from: [http://dx.doi.org/10.1007/s00285-008-0212-0](http://dx.doi.org/10.1007/s00285-008-0212-0). pmid:18841363
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/18841363 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Individual-based+and+continuum+models+of+growing+cell+populations%3A+a+comparison+Byrne+2009 "Go to article in Google Scholar")
50.  50\. Hoops S, Sahle S, Gauges R, Lee C, Pahle J, Simus N, et al. COPASI—a COmplex PAthway SImulator. Bioinformatics. 2006;22(24):3067–3074. Available from: [http://dx.doi.org/10.1093/bioinformatics/btl485](http://dx.doi.org/10.1093/bioinformatics/btl485). pmid:17032683
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/17032683 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=COPASI%E2%80%94a+COmplex+PAthway+SImulator+Hoops+2006 "Go to article in Google Scholar")
51.  51\. Chu YS, Dufour S, Thiery JP, Perez E, Pincet F. Johnson-Kendall-Roberts Theory Applied to Living Cells. Phys Rev Lett. 2005 Jan;94:028102. Available from: [https://doi.org/10.1103/PhysRevLett.94.028102](https://doi.org/10.1103/PhysRevLett.94.028102). pmid:15698233
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [PubMed/NCBI](http://www.ncbi.nlm.nih.gov/pubmed/15698233 "Go to article in PubMed")
    -   [Google Scholar](http://scholar.google.com/scholar?q=Johnson-Kendall-Roberts+Theory+Applied+to+Living+Cells+Chu+2005 "Go to article in Google Scholar")
52.  52\. Buske P, Galle J, Barker N, Aust G, Clevers H, Loeffler M. A Comprehensive Model of the Spatio-Temporal Stem Cell and Tissue Organisation in the Intestinal Crypt. PLoS Comput Biol. 2011 01;7(1):1–13. Available from: [http://dx.doi.org/10.1371/journal.pcbi.1001045](http://dx.doi.org/10.1371/journal.pcbi.1001045).
    -   [View Article](https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1005991# "Go to article in CrossRef")
    -   [Google Scholar](http://scholar.google.com/scholar?q=A+Comprehensive+Model+of+the+Spatio-Temporal+Stem+Cell+and+Tissue+Organisation+in+the+Intestinal+Crypt+Buske+2011 "Go to article in Google Scholar")
53.  53\. National Science Foundation. Award Abstract 1720625: Network for Computational Nanotechnology-Engineered nanoBIO Node (PI: Fox; Co-PIs: Glazier, Douglas, Jadhao and Macklin); 2017–22. Available from: [https://www.nsf.gov/awardsearch/showAward?AWD\_ID=1720625](https://www.nsf.gov/awardsearch/showAward?AWD_ID=1720625).